<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Binder">
<meta name="author" content="Florian Pfisterer">
<meta name="author" content="Michel Lang">
<meta name="dcterms.date" content="2020-03-11">
<meta name="description" content="Train different models.">

<title>German Credit Series - Basics – mlr-org</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-1fa5e93acb50773330e542bbd58c1e25.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 2,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 5,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">mlr-org</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-overview" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Overview</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-overview">    
        <li>
    <a class="dropdown-item" href="../../../ecosystem.html">
 <span class="dropdown-text">Ecosystem</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../dependencies.html">
 <span class="dropdown-text">Dependencies</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../../tasks.html">
 <span class="dropdown-text">Tasks</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../learners.html">
 <span class="dropdown-text">Learners</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resamplings.html">
 <span class="dropdown-text">Resamplings</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../measures.html">
 <span class="dropdown-text">Measures</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../../pipeops.html">
 <span class="dropdown-text">Pipeline Operators</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../graphs.html">
 <span class="dropdown-text">Graphs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../torch_pipeops.html">
 <span class="dropdown-text">Torch Pipeline Operators</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../../tuners.html">
 <span class="dropdown-text">Tuners</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../tuning_spaces.html">
 <span class="dropdown-text">Tuning Spaces</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../terminators.html">
 <span class="dropdown-text">Terminators</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../../filters.html">
 <span class="dropdown-text">Feature Selection Filter</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../fselectors.html">
 <span class="dropdown-text">Feature Selection Wrapper</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../book.html"> 
<span class="menu-text">Book</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../gallery.html"> 
<span class="menu-text">Gallery</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-benchmarks" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Benchmarks</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-benchmarks">    
        <li>
    <a class="dropdown-item" href="../../../benchmarks/benchmarks_mlr3.html">
 <span class="dropdown-text">mlr3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../benchmarks/benchmarks_mlr3fselect.html">
 <span class="dropdown-text">mlr3fselect</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../benchmarks/benchmarks_mlr3tuning.html">
 <span class="dropdown-text">mlr3tuning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../benchmarks/benchmarks_async.html">
 <span class="dropdown-text">mlr3tuning async</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../benchmarks/benchmark_rush.html">
 <span class="dropdown-text">rush</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../benchmarks/benchmarks_paradox.html">
 <span class="dropdown-text">paradox</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../team.html"> 
<span class="menu-text">Team</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">More</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-more">    
        <li>
    <a class="dropdown-item" href="../../../support.html">
 <span class="dropdown-text">Support</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contributing.html">
 <span class="dropdown-text">Contributing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../faq.html">
 <span class="dropdown-text">Frequently Asked Questions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../blogroll.html">
 <span class="dropdown-text">Blogroll</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-rss" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-rss">    
        <li>
    <a class="dropdown-item" href="../../../gallery-all.xml">
 <span class="dropdown-text">Gallery RSS</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite"> <i class="bi bi-chat-dots" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://stackoverflow.com/questions/tagged/mlr3"> <i class="bi bi-stack-overflow" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mlr-org"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">German Credit Series - Basics</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
  <div id="quarto-announcement" data-announcement-id="2a29a73f7e8b4063ece399653c838ff3" class="alert alert-primary hidden"><i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p>The website features runtime <a href="benchmarks/benchmarks_paradox.qmd">benchmarks</a> of the paradox package now.</p>
</div><i class="bi bi-x-lg quarto-announcement-action"></i></div>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">German Credit Series - Basics</h1>
                  <div>
        <div class="description">
          <p>Train different models.</p>
        </div>
      </div>
                </div>
  </div>

  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Authors</div>
      <div class="quarto-title-meta-contents">
               <p>Martin Binder </p>
               <p>Florian Pfisterer </p>
               <p>Michel Lang </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 11, 2020</p>
      </div>
    </div>
    
      
    </div>
    

  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro">Intro</a></li>
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites">Prerequisites</a></li>
  <li><a href="#machine-learning-use-case-german-credit-data" id="toc-machine-learning-use-case-german-credit-data" class="nav-link" data-scroll-target="#machine-learning-use-case-german-credit-data">Machine Learning Use Case: German Credit Data</a>
  <ul class="collapse">
  <li><a href="#importing-the-data" id="toc-importing-the-data" class="nav-link" data-scroll-target="#importing-the-data">Importing the Data</a></li>
  <li><a href="#exploring-the-data" id="toc-exploring-the-data" class="nav-link" data-scroll-target="#exploring-the-data">Exploring the Data</a></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling">Modeling</a>
  <ul class="collapse">
  <li><a href="#task-definition" id="toc-task-definition" class="nav-link" data-scroll-target="#task-definition">Task Definition</a></li>
  <li><a href="#learner-definition" id="toc-learner-definition" class="nav-link" data-scroll-target="#learner-definition">Learner Definition</a></li>
  <li><a href="#training" id="toc-training" class="nav-link" data-scroll-target="#training">Training</a></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction">Prediction</a></li>
  <li><a href="#performance-evaluation" id="toc-performance-evaluation" class="nav-link" data-scroll-target="#performance-evaluation">Performance Evaluation</a></li>
  <li><a href="#performance-comparison-and-benchmarks" id="toc-performance-comparison-and-benchmarks" class="nav-link" data-scroll-target="#performance-comparison-and-benchmarks">Performance Comparison and Benchmarks</a></li>
  </ul></li>
  <li><a href="#deviating-from-hyperparameters-defaults" id="toc-deviating-from-hyperparameters-defaults" class="nav-link" data-scroll-target="#deviating-from-hyperparameters-defaults">Deviating from hyperparameters defaults</a></li>
  <li><a href="#outlook" id="toc-outlook" class="nav-link" data-scroll-target="#outlook">Outlook</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Intro</h2>
<p>This is the first part in a serial of tutorials. The other parts of this series can be found here:</p>
<ul>
<li><a href="../../../gallery/basic/2020-03-11-mlr3tuning-tutorial-german-credit/">Part II - Tuning</a></li>
<li><a href="../../../gallery/basic/2020-03-11-mlr3pipelines-tutorial-german-credit/">Part III - Pipelines</a></li>
</ul>
<p>We will walk through this tutorial interactively. The text is kept short to be followed in real time.</p>
</section>
<section id="prerequisites" class="level2">
<h2 class="anchored" data-anchor-id="prerequisites">Prerequisites</h2>
<p>Ensure all packages used in this tutorial are installed. This includes the <a href="https://mlr3verse.mlr-org.com">mlr3verse</a> package, as well as other packages for data handling, cleaning and visualization which we are going to use (<a href="https://cran.r-project.org/package=data.table">data.table</a>, <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>, <a href="https://cran.r-project.org/package=rchallenge">rchallenge</a>, and <a href="https://cran.r-project.org/package=skimr">skimr</a>).</p>
<p>Then, load the main packages we are going to use:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mlr3verse"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mlr3learners"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mlr3tuning"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"data.table"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>lgr<span class="sc">::</span><span class="fu">get_logger</span>(<span class="st">"mlr3"</span>)<span class="sc">$</span><span class="fu">set_threshold</span>(<span class="st">"warn"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="machine-learning-use-case-german-credit-data" class="level2">
<h2 class="anchored" data-anchor-id="machine-learning-use-case-german-credit-data">Machine Learning Use Case: German Credit Data</h2>
<p>The German credit data was originally donated in 1994 by Prof.&nbsp;Dr.&nbsp;Hans Hoffman of the University of Hamburg. A description can be found at the <a href="https://archive.ics.uci.edu/ml/datasets/Statlog+%28German+Credit+Data%29">UCI repository</a>. The goal is to classify people by their credit risk (good or bad) using 20 personal, demographic and financial features:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th>Feature Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>age</td>
<td>age in years</td>
</tr>
<tr class="even">
<td>amount</td>
<td>amount asked by applicant</td>
</tr>
<tr class="odd">
<td>credit_history</td>
<td>past credit history of applicant at this bank</td>
</tr>
<tr class="even">
<td>duration</td>
<td>duration of the credit in months</td>
</tr>
<tr class="odd">
<td>employment_duration</td>
<td>present employment since</td>
</tr>
<tr class="even">
<td>foreign_worker</td>
<td>is applicant foreign worker?</td>
</tr>
<tr class="odd">
<td>housing</td>
<td>type of apartment rented, owned, for free / no payment</td>
</tr>
<tr class="even">
<td>installment_rate</td>
<td>installment rate in percentage of disposable income</td>
</tr>
<tr class="odd">
<td>job</td>
<td>current job information</td>
</tr>
<tr class="even">
<td>number_credits</td>
<td>number of existing credits at this bank</td>
</tr>
<tr class="odd">
<td>other_debtors</td>
<td>other debtors/guarantors present?</td>
</tr>
<tr class="even">
<td>other_installment_plans</td>
<td>other installment plans the applicant is paying</td>
</tr>
<tr class="odd">
<td>people_liable</td>
<td>number of people being liable to provide maintenance</td>
</tr>
<tr class="even">
<td>personal_status_sex</td>
<td>combination of sex and personal status of applicant</td>
</tr>
<tr class="odd">
<td>present_residence</td>
<td>present residence since</td>
</tr>
<tr class="even">
<td>property</td>
<td>properties that applicant has</td>
</tr>
<tr class="odd">
<td>purpose</td>
<td>reason customer is applying for a loan</td>
</tr>
<tr class="even">
<td>savings</td>
<td>savings accounts/bonds at this bank</td>
</tr>
<tr class="odd">
<td>status</td>
<td>status/balance of checking account at this bank</td>
</tr>
<tr class="even">
<td>telephone</td>
<td>is there any telephone registered for this customer?</td>
</tr>
</tbody>
</table>
<section id="importing-the-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-data">Importing the Data</h3>
<p>The dataset we are going to use is a transformed version of this German credit dataset, as provided by the <a href="https://cran.r-project.org/package=rchallenge">rchallenge</a> package (this transformed dataset was proposed by Ulrike Grömping, with factors instead of dummy variables and corrected features):</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"german"</span>, <span class="at">package =</span> <span class="st">"rchallenge"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>First, we’ll do a thorough investigation of the dataset.</p>
</section>
<section id="exploring-the-data" class="level3">
<h3 class="anchored" data-anchor-id="exploring-the-data">Exploring the Data</h3>
<p>We can get a quick overview of our dataset using R’s summary function:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(german)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1000   21</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(german)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1000 obs. of  21 variables:
 $ status                 : Factor w/ 4 levels "no checking account",..: 1 1 2 1 1 1 1 1 4 2 ...
 $ duration               : int  18 9 12 12 12 10 8 6 18 24 ...
 $ credit_history         : Factor w/ 5 levels "delay in paying off in the past",..: 5 5 3 5 5 5 5 5 5 3 ...
 $ purpose                : Factor w/ 11 levels "others","car (new)",..: 3 1 10 1 1 1 1 1 4 4 ...
 $ amount                 : int  1049 2799 841 2122 2171 2241 3398 1361 1098 3758 ...
 $ savings                : Factor w/ 5 levels "unknown/no savings account",..: 1 1 2 1 1 1 1 1 1 3 ...
 $ employment_duration    : Factor w/ 5 levels "unemployed","&lt; 1 yr",..: 2 3 4 3 3 2 4 2 1 1 ...
 $ installment_rate       : Ord.factor w/ 4 levels "&gt;= 35"&lt;"25 &lt;= ... &lt; 35"&lt;..: 4 2 2 3 4 1 1 2 4 1 ...
 $ personal_status_sex    : Factor w/ 4 levels "male : divorced/separated",..: 2 3 2 3 3 3 3 3 2 2 ...
 $ other_debtors          : Factor w/ 3 levels "none","co-applicant",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ present_residence      : Ord.factor w/ 4 levels "&lt; 1 yr"&lt;"1 &lt;= ... &lt; 4 yrs"&lt;..: 4 2 4 2 4 3 4 4 4 4 ...
 $ property               : Factor w/ 4 levels "unknown / no property",..: 2 1 1 1 2 1 1 1 3 4 ...
 $ age                    : int  21 36 23 39 38 48 39 40 65 23 ...
 $ other_installment_plans: Factor w/ 3 levels "bank","stores",..: 3 3 3 3 1 3 3 3 3 3 ...
 $ housing                : Factor w/ 3 levels "for free","rent",..: 1 1 1 1 2 1 2 2 2 1 ...
 $ number_credits         : Ord.factor w/ 4 levels "1"&lt;"2-3"&lt;"4-5"&lt;..: 1 2 1 2 2 2 2 1 2 1 ...
 $ job                    : Factor w/ 4 levels "unemployed/unskilled - non-resident",..: 3 3 2 2 2 2 2 2 1 1 ...
 $ people_liable          : Factor w/ 2 levels "3 or more","0 to 2": 2 1 2 1 2 1 2 1 2 2 ...
 $ telephone              : Factor w/ 2 levels "no","yes (under customer name)": 1 1 1 1 1 1 1 1 1 1 ...
 $ foreign_worker         : Factor w/ 2 levels "yes","no": 2 2 2 1 1 1 1 1 2 2 ...
 $ credit_risk            : Factor w/ 2 levels "bad","good": 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
</div>
</div>
<p>Our dataset has 1000 observations and 21 columns. The variable we want to predict is <code>credit_risk</code> (either good or bad), i.e., we aim to classify people by their credit risk.</p>
<p>We also recommend the <a href="https://cran.r-project.org/package=skimr">skimr</a> package as it creates very well readable and understandable overviews:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(german)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">german</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">factor</td>
<td style="text-align: left;">18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">ordered</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: left;">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">status</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">…: 394, no : 274, …: 269, 0&lt;=: 63</td>
</tr>
<tr class="even">
<td style="text-align: left;">credit_history</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">no : 530, all: 293, exi: 88, cri: 49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">purpose</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">fur: 280, oth: 234, car: 181, car: 103</td>
</tr>
<tr class="even">
<td style="text-align: left;">savings</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">unk: 603, …: 183, …: 103, 100: 63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">employment_duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">1 &lt;: 339, &gt;= : 253, 4 &lt;: 174, &lt; 1: 172</td>
</tr>
<tr class="even">
<td style="text-align: left;">installment_rate</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">&lt; 2: 476, 25 : 231, 20 : 157, &gt;= : 136</td>
</tr>
<tr class="odd">
<td style="text-align: left;">personal_status_sex</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">mal: 548, fem: 310, fem: 92, mal: 50</td>
</tr>
<tr class="even">
<td style="text-align: left;">other_debtors</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">non: 907, gua: 52, co-: 41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">present_residence</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">&gt;= : 413, 1 &lt;: 308, 4 &lt;: 149, &lt; 1: 130</td>
</tr>
<tr class="even">
<td style="text-align: left;">property</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">bui: 332, unk: 282, car: 232, rea: 154</td>
</tr>
<tr class="odd">
<td style="text-align: left;">other_installment_plans</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">non: 814, ban: 139, sto: 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">housing</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">ren: 714, for: 179, own: 107</td>
</tr>
<tr class="odd">
<td style="text-align: left;">number_credits</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">1: 633, 2-3: 333, 4-5: 28, &gt;= : 6</td>
</tr>
<tr class="even">
<td style="text-align: left;">job</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">ski: 630, uns: 200, man: 148, une: 22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">people_liable</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0 t: 845, 3 o: 155</td>
</tr>
<tr class="even">
<td style="text-align: left;">telephone</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">no: 596, yes: 404</td>
</tr>
<tr class="odd">
<td style="text-align: left;">foreign_worker</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">no: 963, yes: 37</td>
</tr>
<tr class="even">
<td style="text-align: left;">credit_risk</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">goo: 700, bad: 300</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20.90</td>
<td style="text-align: right;">12.06</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">18.0</td>
<td style="text-align: right;">24.00</td>
<td style="text-align: right;">72</td>
<td style="text-align: left;">▇▇▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">amount</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3271.25</td>
<td style="text-align: right;">2822.75</td>
<td style="text-align: right;">250</td>
<td style="text-align: right;">1365.5</td>
<td style="text-align: right;">2319.5</td>
<td style="text-align: right;">3972.25</td>
<td style="text-align: right;">18424</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">35.54</td>
<td style="text-align: right;">11.35</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">27.0</td>
<td style="text-align: right;">33.0</td>
<td style="text-align: right;">42.00</td>
<td style="text-align: right;">75</td>
<td style="text-align: left;">▇▆▃▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>During an exploratory analysis meaningful discoveries could be:</p>
<ul>
<li>Skewed distributions</li>
<li>Missing values</li>
<li>Empty / rare factor variables</li>
</ul>
<p>An explanatory analysis is crucial to get a feeling for your data. On the other hand the data can be validated this way. Non-plausible data can be investigated or outliers can be removed.</p>
<p>After feeling confident with the data, we want to do modeling now.</p>
</section>
</section>
<section id="modeling" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="modeling">Modeling</h2>
<p>Considering how we are going to tackle the problem of classifying the credit risk relates closely to what <a href="https://mlr3.mlr-org.com">mlr3</a> entities we will use.</p>
<p>The typical questions that arise when building a machine learning workflow are:</p>
<ul>
<li>What is the problem we are trying to solve?</li>
<li>What are appropriate learning algorithms?</li>
<li>How do we evaluate “good” performance?</li>
</ul>
<p>More systematically in <a href="https://mlr3.mlr-org.com">mlr3</a> they can be expressed via five components:</p>
<ol type="1">
<li>The <a href="https://mlr3.mlr-org.com/reference/Task.html"><code>Task</code></a> definition.</li>
<li>The <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> definition.</li>
<li>The training.</li>
<li>The prediction.</li>
<li>The evaluation via one or multiple <a href="https://mlr3.mlr-org.com/reference/Measure.html"><code>Measures</code></a>.</li>
</ol>
<section id="task-definition" class="level3">
<h3 class="anchored" data-anchor-id="task-definition">Task Definition</h3>
<p>First, we are interested in the target which we want to model. Most supervised machine learning problems are <strong>regression</strong> or <strong>classification</strong> problems. However, note that other problems include unsupervised learning or time-to-event data (covered in <a href="https://mlr3proba.mlr-org.com">mlr3proba</a>).</p>
<p>Within <a href="https://mlr3.mlr-org.com">mlr3</a>, to distinguish between these problems, we define <a href="https://mlr3.mlr-org.com/reference/Task.html"><code>Tasks</code></a>. If we want to solve a classification problem, we define a classification task – <a href="https://mlr3.mlr-org.com/reference/TaskClassif.html"><code>TaskClassif</code></a>. For a regression problem, we define a regression task – <a href="https://mlr3.mlr-org.com/reference/TaskRegr.html"><code>TaskRegr</code></a>.</p>
<p>In our case it is clearly our objective to model or predict the binary <code>factor</code> variable <code>credit_risk</code>. Thus, we define a <a href="https://mlr3.mlr-org.com/reference/TaskClassif.html"><code>TaskClassif</code></a>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>task <span class="ot">=</span> <span class="fu">as_task_classif</span>(german, <span class="at">id =</span> <span class="st">"GermanCredit"</span>, <span class="at">target =</span> <span class="st">"credit_risk"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Note that the German credit data is also given as an example task which ships with the <a href="https://mlr3.mlr-org.com">mlr3</a> package. Thus, you actually don’t need to construct it yourself, just call <code>tsk("german_credit")</code> to retrieve the object from the dictionary <a href="https://mlr3.mlr-org.com/reference/mlr_tasks.html"><code>mlr_tasks</code></a>.</p>
</section>
<section id="learner-definition" class="level3">
<h3 class="anchored" data-anchor-id="learner-definition">Learner Definition</h3>
<p>After having decided <em>what</em> should be modeled, we need to decide on <em>how</em>. This means we need to decide which learning algorithms, or <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learners</code></a> are appropriate. Using prior knowledge (e.g.&nbsp;knowing that it is a classification task or assuming that the classes are linearly separable) one ends up with one or more suitable <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a>s.</p>
<p>Many learners can be obtained via the <a href="https://mlr3learners.mlr-org.com">mlr3learners</a> package. Additionally, many learners are provided via the <a href="https://mlr3extralearners.mlr-org.com">mlr3extralearners</a> package, from GitHub. These two resources combined account for a large fraction of standard learning algorithms. As <a href="https://mlr3.mlr-org.com">mlr3</a> usually only wraps learners from packages, it is even easy to create a formal <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> by yourself. You may find the section about <a href="https://mlr3book.mlr-org.com/extending.html">extending mlr3</a> in the <a href="https://cran.r-project.org/package=mlr3book">mlr3book</a> very helpful. If you happen to write your own <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> in <a href="https://mlr3.mlr-org.com">mlr3</a>, we would be happy if you share it with the <a href="https://mlr3.mlr-org.com">mlr3</a> community.</p>
<p>All available <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a>s (i.e.&nbsp;all which you have installed from <a href="https://mlr3.mlr-org.com">mlr3</a>, <code>mlr3learners</code>, <code>mlr3extralearners</code>, or self-written ones) are registered in the dictionary <a href="https://mlr3.mlr-org.com/reference/mlr_learners.html"><code>mlr_learners</code></a>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mlr_learners</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;DictionaryLearner&gt; with 134 stored values
Keys: classif.AdaBoostM1, classif.bart, classif.C50, classif.catboost, classif.cforest, classif.ctree,
  classif.cv_glmnet, classif.debug, classif.earth, classif.featureless, classif.fnn, classif.gam,
  classif.gamboost, classif.gausspr, classif.gbm, classif.glmboost, classif.glmer, classif.glmnet,
  classif.IBk, classif.J48, classif.JRip, classif.kknn, classif.ksvm, classif.lda, classif.liblinear,
  classif.lightgbm, classif.LMT, classif.log_reg, classif.lssvm, classif.mob, classif.multinom,
  classif.naive_bayes, classif.nnet, classif.OneR, classif.PART, classif.qda, classif.randomForest,
  classif.ranger, classif.rfsrc, classif.rpart, classif.svm, classif.xgboost, clust.agnes, clust.ap,
  clust.cmeans, clust.cobweb, clust.dbscan, clust.diana, clust.em, clust.fanny, clust.featureless,
  clust.ff, clust.hclust, clust.kkmeans, clust.kmeans, clust.MBatchKMeans, clust.mclust, clust.meanshift,
  clust.pam, clust.SimpleKMeans, clust.xmeans, dens.kde_ks, dens.locfit, dens.logspline, dens.mixed,
  dens.nonpar, dens.pen, dens.plug, dens.spline, regr.bart, regr.catboost, regr.cforest, regr.ctree,
  regr.cubist, regr.cv_glmnet, regr.debug, regr.earth, regr.featureless, regr.fnn, regr.gam, regr.gamboost,
  regr.gausspr, regr.gbm, regr.glm, regr.glmboost, regr.glmnet, regr.IBk, regr.kknn, regr.km, regr.ksvm,
  regr.liblinear, regr.lightgbm, regr.lm, regr.lmer, regr.M5Rules, regr.mars, regr.mob, regr.nnet,
  regr.randomForest, regr.ranger, regr.rfsrc, regr.rpart, regr.rsm, regr.rvm, regr.svm, regr.xgboost,
  surv.akritas, surv.aorsf, surv.blackboost, surv.cforest, surv.coxboost, surv.coxtime, surv.ctree,
  surv.cv_coxboost, surv.cv_glmnet, surv.deephit, surv.deepsurv, surv.dnnsurv, surv.flexible,
  surv.gamboost, surv.gbm, surv.glmboost, surv.glmnet, surv.loghaz, surv.mboost, surv.nelson,
  surv.obliqueRSF, surv.parametric, surv.pchazard, surv.penalized, surv.ranger, surv.rfsrc, surv.svm,
  surv.xgboost</code></pre>
</div>
</div>
<p>For our problem, a suitable learner could be one of the following: Logistic regression, CART, random forest (or many more).</p>
<p>A learner can be initialized with the <a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html"><code>lrn()</code></a> function and the name of the learner, e.g., <code>lrn("classif.xxx")</code>. Use <code>?mlr_learners_xxx</code> to open the help page of a learner named <code>xxx</code>.</p>
<p>For example, a logistic regression can be initialized in the following manner (logistic regression uses R’s <code>glm()</code> function and is provided by the <code>mlr3learners</code> package):</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mlr3learners"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>learner_logreg <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.log_reg"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(learner_logreg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;LearnerClassifLogReg:classif.log_reg&gt;
* Model: -
* Parameters: list()
* Packages: mlr3, mlr3learners, stats
* Predict Types:  [response], prob
* Feature Types: logical, integer, numeric, character, factor, ordered
* Properties: loglik, twoclass</code></pre>
</div>
</div>
</section>
<section id="training" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="training">Training</h3>
<p>Training is the procedure, where a model is fitted on the (training) data.</p>
<section id="logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h4>
<p>We start with the example of the logistic regression. However, you will immediately see that the procedure generalizes to any learner very easily.</p>
<p>An initialized learner can be trained on data using <code>$train()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>learner_logreg<span class="sc">$</span><span class="fu">train</span>(task)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Typically, in machine learning, one does not use the full data which is available but a subset, the so-called training data.</p>
<p>To efficiently perform a split of the data one could do the following:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>train_set <span class="ot">=</span> <span class="fu">sample</span>(task<span class="sc">$</span>row_ids, <span class="fl">0.8</span> <span class="sc">*</span> task<span class="sc">$</span>nrow)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">=</span> <span class="fu">setdiff</span>(task<span class="sc">$</span>row_ids, train_set)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>80 percent of the data is used for training. The remaining 20 percent are used for evaluation at a subsequent later point in time. <code>train_set</code> is an integer vector referring to the selected rows of the original dataset:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(train_set)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 836 679 129 930 509 471</code></pre>
</div>
</div>
<p>In <a href="https://mlr3.mlr-org.com">mlr3</a> the training with a subset of the data can be declared by the additional argument <code>row_ids = train_set</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>learner_logreg<span class="sc">$</span><span class="fu">train</span>(task, <span class="at">row_ids =</span> train_set)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The fitted model can be accessed via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>learner_logreg<span class="sc">$</span>model</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  stats::glm(formula = task$formula(), family = "binomial", data = data, 
    model = FALSE)

Coefficients:
                                              (Intercept)                                                        age  
                                                0.0688846                                                 -0.0159818  
                                                   amount     credit_historycritical account/other credits elsewhere  
                                                0.0001329                                                  0.4580373  
credit_historyno credits taken/all credits paid back duly     credit_historyexisting credits paid back duly till now  
                                               -0.5087518                                                 -1.0249187  
    credit_historyall credits at this bank paid back duly                                                   duration  
                                               -1.5582920                                                  0.0360543  
                                employment_duration&lt; 1 yr                        employment_duration1 &lt;= ... &lt; 4 yrs  
                                                0.0720620                                                 -0.1262893  
                      employment_duration4 &lt;= ... &lt; 7 yrs                                employment_duration&gt;= 7 yrs  
                                               -0.5589136                                                 -0.1545512  
                                         foreign_workerno                                                housingrent  
                                                1.3647905                                                 -0.6199554  
                                               housingown                                         installment_rate.L  
                                               -0.6851413                                                  0.8838467  
                                       installment_rate.Q                                         installment_rate.C  
                                               -0.0385000                                                 -0.1072466  
                                  jobunskilled - resident                               jobskilled employee/official  
                                                0.9797910                                                  0.7657897  
            jobmanager/self-empl./highly qualif. employee                                           number_credits.L  
                                                0.5793418                                                  0.4081443  
                                         number_credits.Q                                           number_credits.C  
                                               -0.3386148                                                 -0.0262034  
                                other_debtorsco-applicant                                     other_debtorsguarantor  
                                                0.4995457                                                 -0.4840799  
                            other_installment_plansstores                                other_installment_plansnone  
                                                0.1844457                                                 -0.2035917  
                                      people_liable0 to 2    personal_status_sexfemale : non-single or male : single  
                                               -0.2306212                                                 -0.2797497  
                personal_status_sexmale : married/widowed                         personal_status_sexfemale : single  
                                               -0.7947385                                                 -0.4173530  
                                      present_residence.L                                        present_residence.Q  
                                                0.0948244                                                 -0.4654771  
                                      present_residence.C                                       propertycar or other  
                                                0.2317025                                                  0.2583020  
        propertybuilding soc. savings agr./life insurance                                        propertyreal estate  
                                                0.2595201                                                  0.6821534  
                                         purposecar (new)                                          purposecar (used)  
                                               -1.5120761                                                 -0.6224479  
                               purposefurniture/equipment                                    purposeradio/television  
                                               -0.7776132                                                 -0.1649750  
                               purposedomestic appliances                                             purposerepairs  
                                                0.1966830                                                  0.3824875  
                                          purposevacation                                          purposeretraining  
                                               -1.9184037                                                 -0.9364954  
                                          purposebusiness                                       savings... &lt;  100 DM  
                                               -1.2647440                                                 -0.2148135  
                              savings100 &lt;= ... &lt;  500 DM                                savings500 &lt;= ... &lt; 1000 DM  
                                               -0.5445696                                                 -1.4241969  
                                    savings... &gt;= 1000 DM                                           status... &lt; 0 DM  
                                               -1.0478097                                                 -0.4584854  
                                   status0&lt;= ... &lt; 200 DM           status... &gt;= 200 DM / salary for at least 1 year  
                                               -0.8798435                                                 -1.7552018  
                       telephoneyes (under customer name)  
                                               -0.1798432  

Degrees of Freedom: 799 Total (i.e. Null);  745 Residual
Null Deviance:      980.7 
Residual Deviance: 702.6    AIC: 812.6</code></pre>
</div>
</div>
<p>The stored object is a normal <code>glm</code> object and all its <code>S3</code> methods work as expected:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(learner_logreg<span class="sc">$</span>model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "glm" "lm" </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(learner_logreg<span class="sc">$</span>model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
stats::glm(formula = task$formula(), family = "binomial", data = data, 
    model = FALSE)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3992  -0.6812  -0.3642   0.6939   2.7540  

Coefficients:
                                                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                                0.0688846  1.3333299   0.052 0.958797    
age                                                       -0.0159818  0.0105444  -1.516 0.129605    
amount                                                     0.0001329  0.0000502   2.647 0.008110 ** 
credit_historycritical account/other credits elsewhere     0.4580373  0.6523911   0.702 0.482623    
credit_historyno credits taken/all credits paid back duly -0.5087518  0.4802925  -1.059 0.289484    
credit_historyexisting credits paid back duly till now    -1.0249188  0.5343038  -1.918 0.055082 .  
credit_historyall credits at this bank paid back duly     -1.5582920  0.4858084  -3.208 0.001338 ** 
duration                                                   0.0360543  0.0106583   3.383 0.000718 ***
employment_duration&lt; 1 yr                                  0.0720620  0.4845297   0.149 0.881770    
employment_duration1 &lt;= ... &lt; 4 yrs                       -0.1262893  0.4577516  -0.276 0.782632    
employment_duration4 &lt;= ... &lt; 7 yrs                       -0.5589136  0.5016876  -1.114 0.265250    
employment_duration&gt;= 7 yrs                               -0.1545512  0.4625121  -0.334 0.738262    
foreign_workerno                                           1.3647905  0.6425196   2.124 0.033660 *  
housingrent                                               -0.6199554  0.2705326  -2.292 0.021928 *  
housingown                                                -0.6851413  0.5581021  -1.228 0.219587    
installment_rate.L                                         0.8838467  0.2472850   3.574 0.000351 ***
installment_rate.Q                                        -0.0385001  0.2217440  -0.174 0.862161    
installment_rate.C                                        -0.1072466  0.2281857  -0.470 0.638357    
jobunskilled - resident                                    0.9797910  0.7877153   1.244 0.213559    
jobskilled employee/official                               0.7657897  0.7627061   1.004 0.315358    
jobmanager/self-empl./highly qualif. employee              0.5793418  0.7790492   0.744 0.457087    
number_credits.L                                           0.4081443  0.7356488   0.555 0.579026    
number_credits.Q                                          -0.3386148  0.6189845  -0.547 0.584345    
number_credits.C                                          -0.0262034  0.4717322  -0.056 0.955703    
other_debtorsco-applicant                                  0.4995457  0.4504675   1.109 0.267452    
other_debtorsguarantor                                    -0.4840799  0.4744964  -1.020 0.307635    
other_installment_plansstores                              0.1844457  0.4733765   0.390 0.696804    
other_installment_plansnone                               -0.2035917  0.2881916  -0.706 0.479911    
people_liable0 to 2                                       -0.2306212  0.2905750  -0.794 0.427386    
personal_status_sexfemale : non-single or male : single   -0.2797497  0.4602069  -0.608 0.543268    
personal_status_sexmale : married/widowed                 -0.7947384  0.4513890  -1.761 0.078297 .  
personal_status_sexfemale : single                        -0.4173530  0.5348044  -0.780 0.435165    
present_residence.L                                        0.0948244  0.2496873   0.380 0.704114    
present_residence.Q                                       -0.4654771  0.2293239  -2.030 0.042379 *  
present_residence.C                                        0.2317025  0.2240902   1.034 0.301150    
propertycar or other                                       0.2583020  0.2934956   0.880 0.378812    
propertybuilding soc. savings agr./life insurance          0.2595201  0.2712751   0.957 0.338735    
propertyreal estate                                        0.6821535  0.4931574   1.383 0.166592    
purposecar (new)                                          -1.5120761  0.4173677  -3.623 0.000291 ***
purposecar (used)                                         -0.6224479  0.2979802  -2.089 0.036718 *  
purposefurniture/equipment                                -0.7776132  0.2803938  -2.773 0.005549 ** 
purposeradio/television                                   -0.1649750  0.8289212  -0.199 0.842244    
purposedomestic appliances                                 0.1966830  0.6322897   0.311 0.755751    
purposerepairs                                             0.3824875  0.4657037   0.821 0.411469    
purposevacation                                           -1.9184037  1.1948196  -1.606 0.108362    
purposeretraining                                         -0.9364954  0.4014654  -2.333 0.019664 *  
purposebusiness                                           -1.2647440  0.8064326  -1.568 0.116807    
savings... &lt;  100 DM                                      -0.2148135  0.3235401  -0.664 0.506724    
savings100 &lt;= ... &lt;  500 DM                               -0.5445696  0.5037257  -1.081 0.279660    
savings500 &lt;= ... &lt; 1000 DM                               -1.4241969  0.6223390  -2.288 0.022111 *  
savings... &gt;= 1000 DM                                     -1.0478097  0.3067055  -3.416 0.000635 ***
status... &lt; 0 DM                                          -0.4584854  0.2481344  -1.848 0.064641 .  
status0&lt;= ... &lt; 200 DM                                    -0.8798435  0.4219102  -2.085 0.037035 *  
status... &gt;= 200 DM / salary for at least 1 year          -1.7552018  0.2629099  -6.676 2.45e-11 ***
telephoneyes (under customer name)                        -0.1798432  0.2322797  -0.774 0.438781    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 980.75  on 799  degrees of freedom
Residual deviance: 702.58  on 745  degrees of freedom
AIC: 812.58

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="random-forest" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="random-forest">Random Forest</h4>
<p>Just like the logistic regression, we could train a random forest instead. We use the fast implementation from the <a href="https://cran.r-project.org/package=ranger">ranger</a> package. For this, we first need to define the learner and then actually train it.</p>
<p>We now additionally supply the importance argument (<code>importance = "permutation"</code>). Doing so, we override the default and let the learner do feature importance determination based on permutation feature importance:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>learner_rf <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.ranger"</span>, <span class="at">importance =</span> <span class="st">"permutation"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>learner_rf<span class="sc">$</span><span class="fu">train</span>(task, <span class="at">row_ids =</span> train_set)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can access the importance values using <code>$importance()</code>:</p>
<div class="cell column-page" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>learner_rf<span class="sc">$</span><span class="fu">importance</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 status                duration                  amount          credit_history                 savings 
           0.0352305897            0.0220794319            0.0126390139            0.0118909925            0.0097629159 
                    age                property     employment_duration        installment_rate           other_debtors 
           0.0089588614            0.0065744135            0.0054059438            0.0039772325            0.0029554567 
                purpose                     job                 housing     personal_status_sex       present_residence 
           0.0029153698            0.0019001816            0.0017784386            0.0016809300            0.0012840096 
              telephone          number_credits other_installment_plans           people_liable          foreign_worker 
           0.0010803276            0.0009842075            0.0004556746            0.0003807613            0.0003657158 </code></pre>
</div>
</div>
<p>In order to obtain a plot for the importance values, we convert the importance to a <a href="https://cran.r-project.org/package=data.table">data.table</a> and then process it with <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>importance <span class="ot">=</span> <span class="fu">as.data.table</span>(learner_rf<span class="sc">$</span><span class="fu">importance</span>(), <span class="at">keep.rownames =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(importance) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Feature"</span>, <span class="st">"Importance"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(importance, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Feature, Importance), <span class="at">y =</span> Importance)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/2020-03-11-basics-german-credit-016-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="prediction" class="level3">
<h3 class="anchored" data-anchor-id="prediction">Prediction</h3>
<p>Let’s see what the models predict.</p>
<p>After training a model, the model can be used for prediction. Usually, prediction is the main purpose of machine learning models.</p>
<p>In our case, the model can be used to classify new credit applicants w.r.t. their associated credit risk (good vs.&nbsp;bad) on the basis of the features. Typically, machine learning models predict numeric values. In the regression case this is very natural. For classification, most models predict scores or probabilities. Based on these values, one can derive class predictions.</p>
<section id="predict-classes" class="level4">
<h4 class="anchored" data-anchor-id="predict-classes">Predict Classes</h4>
<p>First, we directly predict classes:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>prediction_logreg <span class="ot">=</span> learner_logreg<span class="sc">$</span><span class="fu">predict</span>(task, <span class="at">row_ids =</span> test_set)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>prediction_rf <span class="ot">=</span> learner_rf<span class="sc">$</span><span class="fu">predict</span>(task, <span class="at">row_ids =</span> test_set)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>prediction_logreg</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;PredictionClassif&gt; for 200 observations:
    row_ids truth response
         18  good     good
         23   bad      bad
         26  good     good
---                       
        996   bad     good
        997   bad      bad
       1000   bad     good</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>prediction_rf</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;PredictionClassif&gt; for 200 observations:
    row_ids truth response
         18  good     good
         23   bad      bad
         26  good     good
---                       
        996   bad      bad
        997   bad     good
       1000   bad     good</code></pre>
</div>
</div>
<p>The <code>$predict()</code> method returns a <a href="https://mlr3.mlr-org.com/reference/Prediction.html"><code>Prediction</code></a> object. It can be converted to a <a href="https://www.rdocumentation.org/packages/data.table/topics/data.table-package"><code>data.table</code></a> if one wants to use it downstream.</p>
<p>We can also display the prediction results aggregated in a confusion matrix:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>prediction_logreg<span class="sc">$</span>confusion</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        truth
response bad good
    bad   28   17
    good  30  125</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>prediction_rf<span class="sc">$</span>confusion</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        truth
response bad good
    bad   24   13
    good  34  129</code></pre>
</div>
</div>
</section>
<section id="predict-probabilities" class="level4">
<h4 class="anchored" data-anchor-id="predict-probabilities">Predict Probabilities</h4>
<p>Most learners may not only predict a class variable (“response”), but also their degree of “belief” / “uncertainty” in a given response. Typically, we achieve this by setting the <code>$predict_type</code> slot of a <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> to <code>"prob"</code>. Sometimes this needs to be done <em>before</em> the learner is trained. Alternatively, we can directly create the learner with this option: <code>lrn("classif.log_reg", predict_type = "prob")</code>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>learner_logreg<span class="sc">$</span>predict_type <span class="ot">=</span> <span class="st">"prob"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>learner_logreg<span class="sc">$</span><span class="fu">predict</span>(task, <span class="at">row_ids =</span> test_set)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;PredictionClassif&gt; for 200 observations:
    row_ids truth response   prob.bad prob.good
         18  good     good 0.24602549 0.7539745
         23   bad      bad 0.88286383 0.1171362
         26  good     good 0.05730414 0.9426959
---                                            
        996   bad     good 0.49783778 0.5021622
        997   bad      bad 0.59947093 0.4005291
       1000   bad     good 0.42568263 0.5743174</code></pre>
</div>
</div>
<p>Note that sometimes one needs to be cautious when dealing with the probability interpretation of the predictions.</p>
</section>
</section>
<section id="performance-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="performance-evaluation">Performance Evaluation</h3>
<p>To measure the performance of a learner on new unseen data, we usually mimic the scenario of unseen data by splitting up the data into training and test set. The training set is used for training the learner, and the test set is only used for predicting and evaluating the performance of the trained learner. Numerous resampling methods (cross-validation, bootstrap) repeat the splitting process in different ways.</p>
<p>Within <a href="https://mlr3.mlr-org.com">mlr3</a>, we need to specify the resampling strategy using the <a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html"><code>rsmp()</code></a> function:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>resampling <span class="ot">=</span> <span class="fu">rsmp</span>(<span class="st">"holdout"</span>, <span class="at">ratio =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resampling)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ResamplingHoldout&gt;: Holdout
* Iterations: 1
* Instantiated: FALSE
* Parameters: ratio=0.6667</code></pre>
</div>
</div>
<p>Here, we use “holdout”, a simple train-test split (with just one iteration). We use the <a href="https://mlr3.mlr-org.com/reference/resample.html"><code>resample()</code></a> function to undertake the resampling calculation:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">resample</span>(task, <span class="at">learner =</span> learner_logreg, <span class="at">resampling =</span> resampling)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ResampleResult&gt; of 1 iterations
* Task: GermanCredit
* Learner: classif.log_reg
* Warnings: 0 in 0 iterations
* Errors: 0 in 0 iterations</code></pre>
</div>
</div>
<p>The default score of the measure is included in the <code>$aggregate()</code> slot:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span><span class="fu">aggregate</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>classif.ce 
 0.2432432 </code></pre>
</div>
</div>
<p>The default measure in this scenario is the <a href="https://mlr3.mlr-org.com/reference/mlr_measures_classif.ce.html"><code>classification error</code></a>. Lower is better.</p>
<p>We can easily run different resampling strategies, e.g.&nbsp;repeated holdout (<code>"subsampling"</code>), or cross validation. Most methods perform repeated train/predict cycles on different data subsets and aggregate the result (usually as the mean). Doing this manually would require us to write loops. <a href="https://mlr3.mlr-org.com">mlr3</a> does the job for us:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>resampling <span class="ot">=</span> <span class="fu">rsmp</span>(<span class="st">"subsampling"</span>, <span class="at">repeats =</span> <span class="dv">10</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>rr <span class="ot">=</span> <span class="fu">resample</span>(task, <span class="at">learner =</span> learner_logreg, <span class="at">resampling =</span> resampling)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>rr<span class="sc">$</span><span class="fu">aggregate</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>classif.ce 
 0.2474474 </code></pre>
</div>
</div>
<p>Instead, we could also run cross-validation:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>resampling <span class="ot">=</span> resampling <span class="ot">=</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> <span class="dv">10</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>rr <span class="ot">=</span> <span class="fu">resample</span>(task, <span class="at">learner =</span> learner_logreg, <span class="at">resampling =</span> resampling)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>rr<span class="sc">$</span><span class="fu">aggregate</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>classif.ce 
     0.257 </code></pre>
</div>
</div>
<p><a href="https://mlr3.mlr-org.com">mlr3</a> features scores for many more measures. Here, we apply <a href="https://mlr3.mlr-org.com/reference/mlr_measures_classif.fpr.html"><code>mlr_measures_classif.fpr</code></a> for the false positive rate, and <a href="https://mlr3.mlr-org.com/reference/mlr_measures_classif.fnr.html"><code>mlr_measures_classif.fnr</code></a> for the false negative rate. Multiple measures can be provided as a list of measures (which can directly be constructed via <a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html"><code>msrs()</code></a>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># false positive rate</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>rr<span class="sc">$</span><span class="fu">aggregate</span>(<span class="fu">msr</span>(<span class="st">"classif.fpr"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>classif.fpr 
  0.1472895 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># false positive rate and false negative</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>measures <span class="ot">=</span> <span class="fu">msrs</span>(<span class="fu">c</span>(<span class="st">"classif.fpr"</span>, <span class="st">"classif.fnr"</span>))</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>rr<span class="sc">$</span><span class="fu">aggregate</span>(measures)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>classif.fpr classif.fnr 
  0.1472895   0.5197922 </code></pre>
</div>
</div>
<p>There are a few more resampling methods, and quite a few more measures (implemented in <a href="https://cran.r-project.org/package=mlr3measures">mlr3measures</a>). They are automatically registered in the respective dictionaries:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>mlr_resamplings</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;DictionaryResampling&gt; with 9 stored values
Keys: bootstrap, custom, custom_cv, cv, holdout, insample, loo, repeated_cv, subsampling</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mlr_measures</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;DictionaryMeasure&gt; with 67 stored values
Keys: aic, bic, classif.acc, classif.auc, classif.bacc, classif.bbrier, classif.ce, classif.costs,
  classif.dor, classif.fbeta, classif.fdr, classif.fn, classif.fnr, classif.fomr, classif.fp, classif.fpr,
  classif.logloss, classif.mauc_au1p, classif.mauc_au1u, classif.mauc_aunp, classif.mauc_aunu,
  classif.mbrier, classif.mcc, classif.npv, classif.ppv, classif.prauc, classif.precision, classif.recall,
  classif.sensitivity, classif.specificity, classif.tn, classif.tnr, classif.tp, classif.tpr, clust.ch,
  clust.db, clust.dunn, clust.silhouette, clust.wss, debug_classif, oob_error, regr.bias, regr.ktau,
  regr.mae, regr.mape, regr.maxae, regr.medae, regr.medse, regr.mse, regr.msle, regr.pbias, regr.rae,
  regr.rmse, regr.rmsle, regr.rrse, regr.rse, regr.rsq, regr.sae, regr.smape, regr.srho, regr.sse,
  selected_features, sim.jaccard, sim.phi, time_both, time_predict, time_train</code></pre>
</div>
</div>
<p>To get help on a resampling method, use <code>?mlr_resamplings_xxx</code>, for a measure do <code>?mlr_measures_xxx</code>. You can also browse the <a href="https://mlr3.mlr-org.com/reference/index.html">mlr3 reference</a> online.</p>
<p>Note that some measures, for example <a href="https://mlr3.mlr-org.com/reference/mlr_measures_classif.auc.html"><code>AUC</code></a>, require the prediction of probabilities.</p>
</section>
<section id="performance-comparison-and-benchmarks" class="level3">
<h3 class="anchored" data-anchor-id="performance-comparison-and-benchmarks">Performance Comparison and Benchmarks</h3>
<p>We could compare <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learners</code></a> by evaluating <a href="https://mlr3.mlr-org.com/reference/resample.html"><code>resample()</code></a> for each of them manually. However, <a href="https://mlr3.mlr-org.com/reference/benchmark.html"><code>benchmark()</code></a> automatically performs resampling evaluations for multiple learners and tasks. <a href="https://mlr3.mlr-org.com/reference/benchmark_grid.html"><code>benchmark_grid()</code></a> creates fully crossed designs: Multiple <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learners</code></a> for multiple <a href="https://mlr3.mlr-org.com/reference/Task.html"><code>Tasks</code></a> are compared w.r.t. multiple <a href="https://mlr3.mlr-org.com/reference/Resampling.html"><code>Resamplings</code></a>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>learners <span class="ot">=</span> <span class="fu">lrns</span>(<span class="fu">c</span>(<span class="st">"classif.log_reg"</span>, <span class="st">"classif.ranger"</span>), <span class="at">predict_type =</span> <span class="st">"prob"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">=</span> <span class="fu">benchmark_grid</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tasks =</span> task,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">learners =</span> learners,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamplings =</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> <span class="dv">10</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>bmr <span class="ot">=</span> <span class="fu">benchmark</span>(grid)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Careful, large benchmarks may take a long time! This one should take less than a minute, however. In general, we want to use parallelization to speed things up on multi-core machines. For parallelization, <a href="https://mlr3.mlr-org.com">mlr3</a> relies on the <a href="https://cran.r-project.org/package=future">future</a> package:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># future::plan("multicore") # uncomment for parallelization</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In the benchmark we can compare different measures. Here, we look at the <a href="https://mlr3.mlr-org.com/reference/mlr_measures_classif.ce.html"><code>misclassification rate</code></a> and the <a href="https://mlr3.mlr-org.com/reference/mlr_measures_classif.auc.html"><code>AUC</code></a>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>measures <span class="ot">=</span> <span class="fu">msrs</span>(<span class="fu">c</span>(<span class="st">"classif.ce"</span>, <span class="st">"classif.auc"</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>performances <span class="ot">=</span> bmr<span class="sc">$</span><span class="fu">aggregate</span>(measures)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>performances[, <span class="fu">c</span>(<span class="st">"learner_id"</span>, <span class="st">"classif.ce"</span>, <span class="st">"classif.auc"</span>)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        learner_id classif.ce classif.auc
1: classif.log_reg      0.250   0.7646559
2:  classif.ranger      0.239   0.7977865</code></pre>
</div>
</div>
<p>We see that the two models perform very similarly.</p>
</section>
</section>
<section id="deviating-from-hyperparameters-defaults" class="level2">
<h2 class="anchored" data-anchor-id="deviating-from-hyperparameters-defaults">Deviating from hyperparameters defaults</h2>
<p>The previously shown techniques build the backbone of a <a href="https://mlr3.mlr-org.com">mlr3</a>-featured machine learning workflow. However, in most cases one would never proceed in the way we did. While many R packages have carefully selected default settings, they will not perform optimally in any scenario. Typically, we can select the values of such hyperparameters. The (hyper)parameters of a <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> can be accessed and set via its <a href="https://paradox.mlr-org.com/reference/ParamSet.html"><code>ParamSet</code></a> <code>$param_set</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>learner_rf<span class="sc">$</span>param_set</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet&gt;
                              id    class lower upper nlevels        default    parents       value
 1:                        alpha ParamDbl  -Inf   Inf     Inf            0.5                       
 2:       always.split.variables ParamUty    NA    NA     Inf &lt;NoDefault[3]&gt;                       
 3:                class.weights ParamUty    NA    NA     Inf                                      
 4:                      holdout ParamLgl    NA    NA       2          FALSE                       
 5:                   importance ParamFct    NA    NA       4 &lt;NoDefault[3]&gt;            permutation
 6:                   keep.inbag ParamLgl    NA    NA       2          FALSE                       
 7:                    max.depth ParamInt     0   Inf     Inf                                      
 8:                min.node.size ParamInt     1   Inf     Inf                                      
 9:                     min.prop ParamDbl  -Inf   Inf     Inf            0.1                       
10:                      minprop ParamDbl  -Inf   Inf     Inf            0.1                       
11:                         mtry ParamInt     1   Inf     Inf &lt;NoDefault[3]&gt;                       
12:                   mtry.ratio ParamDbl     0     1     Inf &lt;NoDefault[3]&gt;                       
13:            num.random.splits ParamInt     1   Inf     Inf              1  splitrule            
14:                  num.threads ParamInt     1   Inf     Inf              1                      1
15:                    num.trees ParamInt     1   Inf     Inf            500                       
16:                    oob.error ParamLgl    NA    NA       2           TRUE                       
17:        regularization.factor ParamUty    NA    NA     Inf              1                       
18:      regularization.usedepth ParamLgl    NA    NA       2          FALSE                       
19:                      replace ParamLgl    NA    NA       2           TRUE                       
20:    respect.unordered.factors ParamFct    NA    NA       3         ignore                       
21:              sample.fraction ParamDbl     0     1     Inf &lt;NoDefault[3]&gt;                       
22:                  save.memory ParamLgl    NA    NA       2          FALSE                       
23: scale.permutation.importance ParamLgl    NA    NA       2          FALSE importance            
24:                    se.method ParamFct    NA    NA       2        infjack                       
25:                         seed ParamInt  -Inf   Inf     Inf                                      
26:         split.select.weights ParamUty    NA    NA     Inf                                      
27:                    splitrule ParamFct    NA    NA       3           gini                       
28:                      verbose ParamLgl    NA    NA       2           TRUE                       
29:                 write.forest ParamLgl    NA    NA       2           TRUE                       
                              id    class lower upper nlevels        default    parents       value</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>learner_rf<span class="sc">$</span>param_set<span class="sc">$</span>values <span class="ot">=</span> <span class="fu">list</span>(<span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can choose parameters for our learners in two distinct manners. If we have prior knowledge on how the learner should be (hyper-)parameterized, the way to go would be manually entering the parameters in the parameter set. In most cases, however, we would want to tune the learner so that it can search “good” model configurations itself. For now, we only want to compare a few models.</p>
<p>To get an idea on which parameters can be manipulated, we can investigate the parameters of the original package version or look into the parameter set of the learner:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ?ranger::ranger</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.table</span>(learner_rf<span class="sc">$</span>param_set)[, .(id, class, lower, upper)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              id    class lower upper
 1:                        alpha ParamDbl  -Inf   Inf
 2:       always.split.variables ParamUty    NA    NA
 3:                class.weights ParamUty    NA    NA
 4:                      holdout ParamLgl    NA    NA
 5:                   importance ParamFct    NA    NA
 6:                   keep.inbag ParamLgl    NA    NA
 7:                    max.depth ParamInt     0   Inf
 8:                min.node.size ParamInt     1   Inf
 9:                     min.prop ParamDbl  -Inf   Inf
10:                      minprop ParamDbl  -Inf   Inf
11:                         mtry ParamInt     1   Inf
12:                   mtry.ratio ParamDbl     0     1
13:            num.random.splits ParamInt     1   Inf
14:                  num.threads ParamInt     1   Inf
15:                    num.trees ParamInt     1   Inf
16:                    oob.error ParamLgl    NA    NA
17:        regularization.factor ParamUty    NA    NA
18:      regularization.usedepth ParamLgl    NA    NA
19:                      replace ParamLgl    NA    NA
20:    respect.unordered.factors ParamFct    NA    NA
21:              sample.fraction ParamDbl     0     1
22:                  save.memory ParamLgl    NA    NA
23: scale.permutation.importance ParamLgl    NA    NA
24:                    se.method ParamFct    NA    NA
25:                         seed ParamInt  -Inf   Inf
26:         split.select.weights ParamUty    NA    NA
27:                    splitrule ParamFct    NA    NA
28:                      verbose ParamLgl    NA    NA
29:                 write.forest ParamLgl    NA    NA
                              id    class lower upper</code></pre>
</div>
</div>
<p>For the random forest two meaningful parameters which steer model complexity are <code>num.trees</code> and <code>mtry</code>. <code>num.trees</code> defaults to <code>500</code> and <code>mtry</code> to <code>floor(sqrt(ncol(data) - 1))</code>, in our case 4.</p>
<p>In the following we aim to train three different learners:</p>
<ol type="1">
<li>The default random forest.</li>
<li>A random forest with <strong>low</strong> <code>num.trees</code> and <strong>low</strong> <code>mtry</code>.</li>
<li>A random forest with <strong>high</strong> <code>num.trees</code> and <strong>high</strong> <code>mtry</code>.</li>
</ol>
<p>We will benchmark their performance on the German credit dataset. For this we construct the three learners and set the parameters accordingly:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>rf_med <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.ranger"</span>, <span class="at">id =</span> <span class="st">"med"</span>, <span class="at">predict_type =</span> <span class="st">"prob"</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>rf_low <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.ranger"</span>, <span class="at">id =</span> <span class="st">"low"</span>, <span class="at">predict_type =</span> <span class="st">"prob"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">num.trees =</span> <span class="dv">5</span>, <span class="at">mtry =</span> <span class="dv">2</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>rf_high <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.ranger"</span>, <span class="at">id =</span> <span class="st">"high"</span>, <span class="at">predict_type =</span> <span class="st">"prob"</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">num.trees =</span> <span class="dv">1000</span>, <span class="at">mtry =</span> <span class="dv">11</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Once the learners are defined, we can benchmark them:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>learners <span class="ot">=</span> <span class="fu">list</span>(rf_low, rf_med, rf_high)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">=</span> <span class="fu">benchmark_grid</span>(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tasks =</span> task,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">learners =</span> learners,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamplings =</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> <span class="dv">10</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>bmr <span class="ot">=</span> <span class="fu">benchmark</span>(grid)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bmr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;BenchmarkResult&gt; of 30 rows with 3 resampling runs
 nr      task_id learner_id resampling_id iters warnings errors
  1 GermanCredit        low            cv    10        0      0
  2 GermanCredit        med            cv    10        0      0
  3 GermanCredit       high            cv    10        0      0</code></pre>
</div>
</div>
<p>We compare misclassification rate and AUC again:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>measures <span class="ot">=</span> <span class="fu">msrs</span>(<span class="fu">c</span>(<span class="st">"classif.ce"</span>, <span class="st">"classif.auc"</span>))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>performances <span class="ot">=</span> bmr<span class="sc">$</span><span class="fu">aggregate</span>(measures)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>performances[, .(learner_id, classif.ce, classif.auc)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   learner_id classif.ce classif.auc
1:        low      0.278   0.7287261
2:        med      0.240   0.7973700
3:       high      0.233   0.7891017</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(bmr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/2020-03-11-basics-german-credit-038-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The “low” settings seem to underfit a bit, the “high” setting is comparable to the default setting “med”.</p>
</section>
<section id="outlook" class="level2">
<h2 class="anchored" data-anchor-id="outlook">Outlook</h2>
<p>This tutorial was a detailed introduction to machine learning workflows within <a href="https://mlr3.mlr-org.com">mlr3</a>. Having followed this tutorial you should be able to run your first models yourself. Next to that we spiked into performance evaluation and benchmarking. Furthermore, we showed how to customize learners.</p>
<p>The next parts of the tutorial will go more into depth into additional <a href="https://mlr3.mlr-org.com">mlr3</a> topics:</p>
<ul>
<li><p><a href="https://mlr3gallery.mlr-org.com/posts/2020-03-11-mlr3tuning-tutorial-german-credit/">Part II - Tuning</a> introduces you to the <a href="https://mlr3tuning.mlr-org.com">mlr3tuning</a> package</p></li>
<li><p><a href="https://mlr3gallery.mlr-org.com/posts/2020-03-11-mlr3pipelines-tutorial-german-credit/">Part III - Pipelines</a> introduces you to the <a href="https://mlr3pipelines.mlr-org.com">mlr3pipelines</a> package</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/mlr-org\.com\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Created with <i class="bi bi-heart-fill"></i> for #rstats.</p>
</div>   
    <div class="nav-footer-center">
<p>CC BY SA 4.0</p>
</div>
    <div class="nav-footer-right">
<p>Website powered by <a href="https://quarto.org/">quarto</a> and <a href="https://www.netlify.com/">Netlify</a>.</p>
</div>
  </div>
</footer>




</body></html>