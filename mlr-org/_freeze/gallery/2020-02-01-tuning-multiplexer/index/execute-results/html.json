{
  "hash": "a89b1a554a417e98e8d89d6ba03c2259",
  "result": {
    "markdown": "---\ntitle: Tuning Over Multiple Learners\ncategories:\n  - tuning\n  - resampling\n  - classification\nauthor:\n  - name: Jakob Richter\n  - name: Bernd Bischl\ndate: 02-01-2020\ndescription: |\n  This use case shows how to tune over multiple learners for a single task.\nimage: thumbnail.png\n---\n\n\n\n\n\n\nThis use case shows how to tune over multiple learners for a single task.\nYou will learn the following:\n\n* Build a pipeline that can switch between multiple learners\n* Define the hyperparameter search space for the pipeline\n* Run a random or grid search (or any other tuner, always works the same)\n* Run nested resampling for unbiased performance estimates\n\nThis is an advanced use case. What should you know before:\n\n* [mlr3](https://mlr3.mlr-org.com) basics\n* [mlr3tuning](https://mlr3tuning.mlr-org.com) basics, especially [`AutoTuner`](https://mlr3tuning.mlr-org.com/reference/AutoTuner.html)\n* [mlr3pipelines](https://mlr3pipelines.mlr-org.com), especially branching\n\n# The Setup\n\nAssume, you are given some ML task and what to compare a couple of learners, probably because you want to select the best of them at the end of the analysis.\nThat's a super standard scenario, it actually sounds so common that you might wonder: Why an (advanced) blog post about this? With pipelines?\nWe will consider 2 cases: (a) Running the learners in their default, so without tuning, and (b) with tuning.\n\nWe load the [mlr3verse](https://mlr3verse.mlr-org.com) package which pulls in the most important packages for this example.\nThe [mlr3learners](https://mlr3learners.mlr-org.com) package loads additional [`learners`](https://mlr3.mlr-org.com/reference/Learner.html).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(mlr3verse)\nlibrary(mlr3tuning)\nlibrary(mlr3learners)\n```\n:::\n\n\nWe initialize the random number generator with a fixed seed for reproducibility, and decrease the verbosity of the logger to keep the output clearly represented.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(7832)\nlgr::get_logger(\"mlr3\")$set_threshold(\"warn\")\nlgr::get_logger(\"bbotk\")$set_threshold(\"warn\")\n```\n:::\n\n\nLet's define our learners.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlearners = list(\n  lrn(\"classif.xgboost\", id = \"xgb\", eval_metric = \"logloss\"),\n  lrn(\"classif.ranger\", id = \"rf\")\n)\nlearners_ids = sapply(learners, function(x) x$id)\n\ntask = tsk(\"sonar\") # some random data for this demo\ninner_cv2 = rsmp(\"cv\", folds = 2) # inner loop for nested CV\nouter_cv5 = rsmp(\"cv\", folds = 5) # outer loop for nested CV\n```\n:::\n\n\n# Default Parameters\n\n# The Benchmark-Table Approach\nAssume we don't want to perform tuning and or with running all learner in their respective defaults.\nSimply run benchmark on the learners and the tasks. That tabulates our results nicely and shows us what works best.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngrid = benchmark_grid(task, learners, outer_cv5)\nbmr = benchmark(grid)\nbmr$aggregate(measures = msr(\"classif.ce\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   nr      resample_result task_id learner_id resampling_id iters classif.ce\n1:  1 <ResampleResult[21]>   sonar        xgb            cv     5  0.2736353\n2:  2 <ResampleResult[21]>   sonar         rf            cv     5  0.1973287\n```\n:::\n:::\n\n\n# The Pipelines Approach\n\nOk, why would we ever want to change the simple approach above - and use pipelines / tuning for this?\nThree reasons:\n\n1. What we are doing with [`benchmark()`](https://mlr3.mlr-org.com/reference/benchmark.html) is actually statistically flawed, insofar if we report the error of the numerically best method from the benchmark table as its estimated future performance.\n   If we do that we have \"optimized on the CV\" (we basically ran a grid search over our learners!) and we know that this is will produce optimistically biased results.\n   NB: This is a somewhat ridiculous criticism if we are going over only a handful of options, and the bias will be very small.\n   But it will be noticeable if we do this over hundreds of learners, so it is important to understand the underlying problem.\n   This is a somewhat subtle point, and this gallery post is more about technical hints for [mlr3](https://mlr3.mlr-org.com), so we will stop this discussion here.\n2. For some tuning algorithms, you might have a chance to more efficiently select from the set of algorithms than running the full benchmark.\n   Because of the categorical nature of the problem, you will not be able to learn stuff like \"If learner A works bad, I don't have to try learner B\", but you can potentially save some resampling iterations.\n   Assume you have so select from 100 candidates, experiments are expensive, and you use a 20-fold CV.\n   If learner A has super-bad results in the first 5 folds of the CV, you might already want to stop here.\n   \"Racing\" would be such a tuning algorithm.\n3. It helps us to foreshadow what comes later in this post where we tune the learners.\n\n\nThe pipeline just has a single purpose in this example:\nIt should allow us to switch between different learners, depending on a hyperparameter.\nThe pipe consists of three elements:\n\n* [`branch`](https://mlr3pipelines.mlr-org.com/reference/mlr_pipeops_branch.html) pipes incoming data to one of the following elements, on different data channels. We can name these channel on construction with `options`.\n* our learners (combined with [`gunion()`](https://mlr3pipelines.mlr-org.com/reference/gunion.html))\n* [`unbranch`](https://mlr3pipelines.mlr-org.com/reference/mlr_pipeops_unbranch.html) combines the forked paths at the end.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngraph =\n  po(\"branch\", options = learners_ids) %>>%\n  gunion(lapply(learners, po)) %>>%\n  po(\"unbranch\")\ngraph$plot(html = FALSE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/2020-02-01-tuning-multiplexer-006-1.png){fig-align='center' width=960}\n:::\n:::\n\n\nThe pipeline has now quite a lot of available hyperparameters.\nIt includes all hyperparameters from all contained learners.\nBut as we don't tune them here (yet), we don't care (yet).\nBut the first hyperparameter is special.\n`branch.selection` controls over which (named) branching channel our data flows.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngraph$param_set$ids()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"branch.selection\"                \"xgb.alpha\"                       \"xgb.approxcontrib\"              \n [4] \"xgb.base_score\"                  \"xgb.booster\"                     \"xgb.callbacks\"                  \n [7] \"xgb.colsample_bylevel\"           \"xgb.colsample_bynode\"            \"xgb.colsample_bytree\"           \n[10] \"xgb.disable_default_eval_metric\" \"xgb.early_stopping_rounds\"       \"xgb.early_stopping_set\"         \n[13] \"xgb.eta\"                         \"xgb.eval_metric\"                 \"xgb.feature_selector\"           \n[16] \"xgb.feval\"                       \"xgb.gamma\"                       \"xgb.grow_policy\"                \n[19] \"xgb.interaction_constraints\"     \"xgb.iterationrange\"              \"xgb.lambda\"                     \n[22] \"xgb.lambda_bias\"                 \"xgb.max_bin\"                     \"xgb.max_delta_step\"             \n[25] \"xgb.max_depth\"                   \"xgb.max_leaves\"                  \"xgb.maximize\"                   \n[28] \"xgb.min_child_weight\"            \"xgb.missing\"                     \"xgb.monotone_constraints\"       \n[31] \"xgb.normalize_type\"              \"xgb.nrounds\"                     \"xgb.nthread\"                    \n[34] \"xgb.ntreelimit\"                  \"xgb.num_parallel_tree\"           \"xgb.objective\"                  \n[37] \"xgb.one_drop\"                    \"xgb.outputmargin\"                \"xgb.predcontrib\"                \n[40] \"xgb.predictor\"                   \"xgb.predinteraction\"             \"xgb.predleaf\"                   \n[43] \"xgb.print_every_n\"               \"xgb.process_type\"                \"xgb.rate_drop\"                  \n[46] \"xgb.refresh_leaf\"                \"xgb.reshape\"                     \"xgb.seed_per_iteration\"         \n[49] \"xgb.sampling_method\"             \"xgb.sample_type\"                 \"xgb.save_name\"                  \n[52] \"xgb.save_period\"                 \"xgb.scale_pos_weight\"            \"xgb.skip_drop\"                  \n[55] \"xgb.strict_shape\"                \"xgb.subsample\"                   \"xgb.top_k\"                      \n[58] \"xgb.training\"                    \"xgb.tree_method\"                 \"xgb.tweedie_variance_power\"     \n[61] \"xgb.updater\"                     \"xgb.verbose\"                     \"xgb.watchlist\"                  \n[64] \"xgb.xgb_model\"                   \"rf.alpha\"                        \"rf.always.split.variables\"      \n[67] \"rf.class.weights\"                \"rf.holdout\"                      \"rf.importance\"                  \n[70] \"rf.keep.inbag\"                   \"rf.max.depth\"                    \"rf.min.node.size\"               \n[73] \"rf.min.prop\"                     \"rf.minprop\"                      \"rf.mtry\"                        \n[76] \"rf.mtry.ratio\"                   \"rf.num.random.splits\"            \"rf.num.threads\"                 \n[79] \"rf.num.trees\"                    \"rf.oob.error\"                    \"rf.regularization.factor\"       \n[82] \"rf.regularization.usedepth\"      \"rf.replace\"                      \"rf.respect.unordered.factors\"   \n[85] \"rf.sample.fraction\"              \"rf.save.memory\"                  \"rf.scale.permutation.importance\"\n[88] \"rf.se.method\"                    \"rf.seed\"                         \"rf.split.select.weights\"        \n[91] \"rf.splitrule\"                    \"rf.verbose\"                      \"rf.write.forest\"                \n```\n:::\n\n```{.r .cell-code}\ngraph$param_set$params$branch.selection\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 id    class lower upper levels        default\n1: branch.selection ParamFct    NA    NA xgb,rf <NoDefault[3]>\n```\n:::\n:::\n\n\nWe can now tune over this pipeline, and probably running grid search seems a good idea to \"touch\" every\navailable learner.\nNB: We have now written down in (much more complicated code) what we did before with `benchmark`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngraph_learner = as_learner(graph)\ngraph_learner$id = \"g\"\ngraph_learner$param_set$values$branch.selection = to_tune(levels = c(\"rf\", \"xgb\"))\n\ninstance = tune(\n  method = \"grid_search\",\n  task = task,\n  learner = graph_learner,\n  resampling = inner_cv2,\n  measure = msr(\"classif.ce\"))\n\nas.data.table(instance$archive)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"table-responsive\"><table class = 'table'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> branch.selection </th>\n   <th style=\"text-align:right;\"> classif.ce </th>\n   <th style=\"text-align:left;\"> x_domain_branch.selection </th>\n   <th style=\"text-align:right;\"> runtime_learners </th>\n   <th style=\"text-align:left;\"> timestamp </th>\n   <th style=\"text-align:right;\"> batch_nr </th>\n   <th style=\"text-align:right;\"> warnings </th>\n   <th style=\"text-align:right;\"> errors </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.1778846 </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.349 </td>\n   <td style=\"text-align:left;\"> 2022-11-08 19:19:24 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb </td>\n   <td style=\"text-align:right;\"> 0.3269231 </td>\n   <td style=\"text-align:left;\"> xgb </td>\n   <td style=\"text-align:right;\"> 0.284 </td>\n   <td style=\"text-align:left;\"> 2022-11-08 19:19:25 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table></div>\n```\n:::\n:::\n\n\nBut: Via this approach we can now get unbiased performance results via nested resampling and using the [`AutoTuner`](https://mlr3tuning.mlr-org.com/reference/AutoTuner.html) (which would make much more sense if we would select from 100 models and not 2).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nat = auto_tuner(\n  method = \"grid_search\",\n  learner = graph_learner,\n  resampling = inner_cv2,\n  measure = msr(\"classif.ce\"),\n)\n\nrr = resample(task, at, outer_cv5, store_models = TRUE)\n\n# access inner tuning result\nextract_inner_tuning_results(rr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   iteration branch.selection classif.ce learner_param_vals  x_domain task_id learner_id resampling_id\n1:         1               rf  0.2349398          <list[7]> <list[1]>   sonar    g.tuned            cv\n2:         2               rf  0.1626506          <list[7]> <list[1]>   sonar    g.tuned            cv\n3:         3               rf  0.3012048          <list[7]> <list[1]>   sonar    g.tuned            cv\n4:         4               rf  0.2813396          <list[7]> <list[1]>   sonar    g.tuned            cv\n5:         5               rf  0.2932444          <list[7]> <list[1]>   sonar    g.tuned            cv\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"table-responsive\"><table class = 'table'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> iteration </th>\n   <th style=\"text-align:left;\"> branch.selection </th>\n   <th style=\"text-align:right;\"> classif.ce </th>\n   <th style=\"text-align:left;\"> task_id </th>\n   <th style=\"text-align:left;\"> learner_id </th>\n   <th style=\"text-align:left;\"> resampling_id </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.2349398 </td>\n   <td style=\"text-align:left;\"> sonar </td>\n   <td style=\"text-align:left;\"> g.tuned </td>\n   <td style=\"text-align:left;\"> cv </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.1626506 </td>\n   <td style=\"text-align:left;\"> sonar </td>\n   <td style=\"text-align:left;\"> g.tuned </td>\n   <td style=\"text-align:left;\"> cv </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.3012048 </td>\n   <td style=\"text-align:left;\"> sonar </td>\n   <td style=\"text-align:left;\"> g.tuned </td>\n   <td style=\"text-align:left;\"> cv </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.2813396 </td>\n   <td style=\"text-align:left;\"> sonar </td>\n   <td style=\"text-align:left;\"> g.tuned </td>\n   <td style=\"text-align:left;\"> cv </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.2932444 </td>\n   <td style=\"text-align:left;\"> sonar </td>\n   <td style=\"text-align:left;\"> g.tuned </td>\n   <td style=\"text-align:left;\"> cv </td>\n  </tr>\n</tbody>\n</table></div>\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# access inner tuning archives\nextract_inner_tuning_archives(rr)\n```\n:::\n\n::: {.cell .column-page layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-bfd49e83ca45d70031d9\" style=\"width:100%;height:auto;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-bfd49e83ca45d70031d9\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[1,1,2,2,3,3,4,4,5,5],[\"rf\",\"xgb\",\"rf\",\"xgb\",\"xgb\",\"rf\",\"xgb\",\"rf\",\"xgb\",\"rf\"],[0.234939759036145,0.246987951807229,0.162650602409639,0.253012048192771,0.379518072289157,0.301204819277108,0.3714859437751,0.281339644291452,0.335341365461847,0.293244406196213],[\"rf\",\"xgb\",\"rf\",\"xgb\",\"xgb\",\"rf\",\"xgb\",\"rf\",\"xgb\",\"rf\"],[0.336,0.193,0.311,0.157999999999998,0.145999999999999,0.324999999999999,0.177000000000001,0.31,0.186999999999999,0.337],[\"2022-11-08T19:19:25Z\",\"2022-11-08T19:19:26Z\",\"2022-11-08T19:19:27Z\",\"2022-11-08T19:19:27Z\",\"2022-11-08T19:19:28Z\",\"2022-11-08T19:19:29Z\",\"2022-11-08T19:19:30Z\",\"2022-11-08T19:19:30Z\",\"2022-11-08T19:19:31Z\",\"2022-11-08T19:19:31Z\"],[1,2,1,2,1,2,1,2,1,2],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[\"sonar\",\"sonar\",\"sonar\",\"sonar\",\"sonar\",\"sonar\",\"sonar\",\"sonar\",\"sonar\",\"sonar\"],[\"g.tuned\",\"g.tuned\",\"g.tuned\",\"g.tuned\",\"g.tuned\",\"g.tuned\",\"g.tuned\",\"g.tuned\",\"g.tuned\",\"g.tuned\"],[\"cv\",\"cv\",\"cv\",\"cv\",\"cv\",\"cv\",\"cv\",\"cv\",\"cv\",\"cv\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>iteration<\\/th>\\n      <th>branch.selection<\\/th>\\n      <th>classif.ce<\\/th>\\n      <th>x_domain_branch.selection<\\/th>\\n      <th>runtime_learners<\\/th>\\n      <th>timestamp<\\/th>\\n      <th>batch_nr<\\/th>\\n      <th>warnings<\\/th>\\n      <th>errors<\\/th>\\n      <th>task_id<\\/th>\\n      <th>learner_id<\\/th>\\n      <th>resampling_id<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,3,5,7,8,9]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n# Model-Selection and Tuning with Pipelines\n\nNow let's select from our given set of models and tune their hyperparameters.\nOne way to do this is to define a search space for each individual learner, wrap them all with the [`AutoTuner`](https://mlr3tuning.mlr-org.com/reference/AutoTuner.html), then call [`benchmark()`](https://mlr3.mlr-org.com/reference/benchmark.html) on them.\nAs this is pretty standard, we will skip this here, and show an even neater option, where you can tune over models and hyperparameters in one go.\nIf you have quite a large space of potential learners and combine this with an efficient tuning algorithm, this can save quite some time in tuning as you can learn during optimization which options work best and focus on them.\nNB: Many AutoML systems work in a very similar way.\n\n# Define the Search Space\n\nRemember, that the pipeline contains a joint set of all contained hyperparameters.\nPrefixed with the respective PipeOp ID, to make names unique.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nas.data.table(graph$param_set)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"table-responsive\"><table class = 'table'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:left;\"> class </th>\n   <th style=\"text-align:right;\"> lower </th>\n   <th style=\"text-align:right;\"> upper </th>\n   <th style=\"text-align:right;\"> nlevels </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> branch.selection </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.alpha </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.approxcontrib </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.base_score </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> -Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.booster </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.callbacks </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.colsample_bylevel </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.colsample_bynode </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.colsample_bytree </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.disable_default_eval_metric </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.early_stopping_rounds </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.early_stopping_set </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.eta </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.eval_metric </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.feature_selector </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.feval </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.gamma </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.grow_policy </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.interaction_constraints </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.iterationrange </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.lambda </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.lambda_bias </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.max_bin </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.max_delta_step </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.max_depth </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.max_leaves </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.maximize </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.min_child_weight </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.missing </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> -Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.monotone_constraints </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.normalize_type </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.nrounds </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.nthread </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.ntreelimit </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.num_parallel_tree </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.objective </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.one_drop </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.outputmargin </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.predcontrib </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.predictor </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.predinteraction </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.predleaf </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.print_every_n </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.process_type </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.rate_drop </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.refresh_leaf </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.reshape </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.seed_per_iteration </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.sampling_method </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.sample_type </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.save_name </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.save_period </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.scale_pos_weight </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> -Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.skip_drop </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.strict_shape </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.subsample </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.top_k </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.training </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.tree_method </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.tweedie_variance_power </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.updater </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.verbose </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.watchlist </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xgb.xgb_model </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.alpha </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> -Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.always.split.variables </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.class.weights </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.holdout </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.importance </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.keep.inbag </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.max.depth </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.min.node.size </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.min.prop </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> -Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.minprop </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> -Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.mtry </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.mtry.ratio </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.num.random.splits </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.num.threads </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.num.trees </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.oob.error </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.regularization.factor </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.regularization.usedepth </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.replace </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.respect.unordered.factors </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.sample.fraction </td>\n   <td style=\"text-align:left;\"> ParamDbl </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.save.memory </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.scale.permutation.importance </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.se.method </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.seed </td>\n   <td style=\"text-align:left;\"> ParamInt </td>\n   <td style=\"text-align:right;\"> -Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.split.select.weights </td>\n   <td style=\"text-align:left;\"> ParamUty </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> Inf </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.splitrule </td>\n   <td style=\"text-align:left;\"> ParamFct </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.verbose </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rf.write.forest </td>\n   <td style=\"text-align:left;\"> ParamLgl </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n</tbody>\n</table></div>\n```\n:::\n:::\n\n\nWe decide to tune the `mtry` parameter of the random forest and the `nrounds` parameter of xgboost.\nAdditionally, we tune branching parameter that selects our learner.\n\nWe also have to reflect the hierarchical order of the parameter sets (admittedly, this is somewhat inconvenient).\nWe can only set the `mtry` value if the pipe is configured to use the random forest ([`ranger`](https://mlr3learners.mlr-org.com/reference/mlr_learners_classif.ranger.html)).\nThe same applies for the xgboost parameter.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsearch_space = ps(\n  branch.selection = p_fct(c(\"rf\", \"xgb\")),\n  rf.mtry = p_int(1L, 20L, depends = branch.selection == \"rf\"),\n  xgb.nrounds = p_int(1, 500, depends = branch.selection == \"xgb\"))\n```\n:::\n\n\n# Tune the Pipeline with a Random Search\n\nVery similar code as before, we just swap out the search space.\nAnd now use random search.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngraph_learner = as_learner(graph)\ngraph_learner$id = \"g\"\n\ninstance = tune(\n  method = \"random_search\",\n  task = task,\n  learner = graph_learner,\n  resampling = inner_cv2,\n  measure = msr(\"classif.ce\"),\n  term_evals = 10\n)\n\nas.data.table(instance$archive)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    branch.selection classif.ce x_domain_branch.selection runtime_learners           timestamp batch_nr warnings errors\n 1:              xgb  0.3509615                       xgb            0.228 2022-11-08 19:19:33        1        0      0\n 2:              xgb  0.3557692                       xgb            0.169 2022-11-08 19:19:33        2        0      0\n 3:              xgb  0.3509615                       xgb            0.172 2022-11-08 19:19:34        3        0      0\n 4:              xgb  0.3509615                       xgb            0.175 2022-11-08 19:19:34        4        0      0\n 5:               rf  0.2548077                        rf            0.351 2022-11-08 19:19:35        5        0      0\n 6:              xgb  0.3461538                       xgb            0.160 2022-11-08 19:19:35        6        0      0\n 7:               rf  0.2403846                        rf            0.354 2022-11-08 19:19:36        7        0      0\n 8:              xgb  0.3557692                       xgb            0.199 2022-11-08 19:19:36        8        0      0\n 9:               rf  0.2355769                        rf            0.357 2022-11-08 19:19:36        9        0      0\n10:              xgb  0.3509615                       xgb            0.199 2022-11-08 19:19:37       10        0      0\n         resample_result\n 1: <ResampleResult[21]>\n 2: <ResampleResult[21]>\n 3: <ResampleResult[21]>\n 4: <ResampleResult[21]>\n 5: <ResampleResult[21]>\n 6: <ResampleResult[21]>\n 7: <ResampleResult[21]>\n 8: <ResampleResult[21]>\n 9: <ResampleResult[21]>\n10: <ResampleResult[21]>\n```\n:::\n:::\n\n::: {.cell .column-page layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-75396ba1495fa75d6662\" style=\"width:100%;height:auto;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-75396ba1495fa75d6662\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"xgb\",\"xgb\",\"xgb\",\"xgb\",\"rf\",\"xgb\",\"rf\",\"xgb\",\"rf\",\"xgb\"],[0.350961538461538,0.355769230769231,0.350961538461538,0.350961538461538,0.254807692307692,0.346153846153846,0.240384615384615,0.355769230769231,0.235576923076923,0.350961538461538],[\"xgb\",\"xgb\",\"xgb\",\"xgb\",\"rf\",\"xgb\",\"rf\",\"xgb\",\"rf\",\"xgb\"],[0.227999999999998,0.169,0.172000000000004,0.174999999999997,0.351000000000003,0.160000000000004,0.353999999999999,0.199000000000002,0.357000000000003,0.199000000000002],[\"2022-11-08T19:19:33Z\",\"2022-11-08T19:19:33Z\",\"2022-11-08T19:19:34Z\",\"2022-11-08T19:19:34Z\",\"2022-11-08T19:19:35Z\",\"2022-11-08T19:19:35Z\",\"2022-11-08T19:19:36Z\",\"2022-11-08T19:19:36Z\",\"2022-11-08T19:19:36Z\",\"2022-11-08T19:19:37Z\"],[1,2,3,4,5,6,7,8,9,10],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>branch.selection<\\/th>\\n      <th>classif.ce<\\/th>\\n      <th>x_domain_branch.selection<\\/th>\\n      <th>runtime_learners<\\/th>\\n      <th>timestamp<\\/th>\\n      <th>batch_nr<\\/th>\\n      <th>warnings<\\/th>\\n      <th>errors<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,4,6,7,8]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nThe following shows a quick way to visualize the tuning results.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# autoplot(instance, cols_x = c(\"xgb.nrounds\",\"rf.mtry\"))\nautoplot(instance)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/2020-02-01-tuning-multiplexer-023-1.png){fig-align='center' width=960}\n:::\n:::\n\n\nNested resampling, now really needed:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrr = tune_nested(\n  method = \"grid_search\",\n  task = task,\n  learner = graph_learner,\n  inner_resampling = inner_cv2,\n  outer_resampling = outer_cv5,\n  measure = msr(\"classif.ce\"),\n  term_evals = 10L)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# access inner tuning result\nextract_inner_tuning_results(rr)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"table-responsive\"><table class = 'table'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> iteration </th>\n   <th style=\"text-align:left;\"> branch.selection </th>\n   <th style=\"text-align:right;\"> classif.ce </th>\n   <th style=\"text-align:left;\"> learner_param_vals </th>\n   <th style=\"text-align:left;\"> x_domain </th>\n   <th style=\"text-align:left;\"> task_id </th>\n   <th style=\"text-align:left;\"> learner_id </th>\n   <th style=\"text-align:left;\"> resampling_id </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.1626506 </td>\n   <td style=\"text-align:left;\"> none   , logloss, 1      , 1      , 0      , 1      , rf </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:left;\"> sonar </td>\n   <td style=\"text-align:left;\"> g.tuned </td>\n   <td style=\"text-align:left;\"> cv </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.2228916 </td>\n   <td style=\"text-align:left;\"> none   , logloss, 1      , 1      , 0      , 1      , rf </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:left;\"> sonar </td>\n   <td style=\"text-align:left;\"> g.tuned </td>\n   <td style=\"text-align:left;\"> cv </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.2168675 </td>\n   <td style=\"text-align:left;\"> none   , logloss, 1      , 1      , 0      , 1      , rf </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:left;\"> sonar </td>\n   <td style=\"text-align:left;\"> g.tuned </td>\n   <td style=\"text-align:left;\"> cv </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.2454819 </td>\n   <td style=\"text-align:left;\"> none   , logloss, 1      , 1      , 0      , 1      , rf </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:left;\"> sonar </td>\n   <td style=\"text-align:left;\"> g.tuned </td>\n   <td style=\"text-align:left;\"> cv </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:right;\"> 0.2213855 </td>\n   <td style=\"text-align:left;\"> none   , logloss, 1      , 1      , 0      , 1      , rf </td>\n   <td style=\"text-align:left;\"> rf </td>\n   <td style=\"text-align:left;\"> sonar </td>\n   <td style=\"text-align:left;\"> g.tuned </td>\n   <td style=\"text-align:left;\"> cv </td>\n  </tr>\n</tbody>\n</table></div>\n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.25/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.11.3/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.11.3/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.11.3/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}