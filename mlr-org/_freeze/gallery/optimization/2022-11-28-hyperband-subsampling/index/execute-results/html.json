{
  "hash": "24660cb7fd7340a30b3c6108356f210b",
  "result": {
    "markdown": "---\ntitle: \"Hyperband and Data Set Subsampling\"\ndescription: |\n  Optimize the hyperparameters of learners that lack a natural fidelity parameter.\ncategories:\n  - tuning\n  - classification\nauthor:\n  - name: Marc Becker\n    url: https://github.com/be-marc\ndate: 2022-11-28\nknitr:\n  opts_chunk:\n    R.options:\n      datatable.print.nrows: 6\n---\n\n\n\n\n\n\n# Scope\n\nIncreasingly large data sets and search spaces make optimization a very time-consuming task.\nHyperband solves this problem by allocating more resources to promising configurations and terminating low-performing ones.\nThe resource can be the number of training epochs in a neural network, the number of trees in a gradient-boosting algorithm, or the size of the training data set.\nIn this post, we use the size of the training data set to optimize the hyperparameters of a support vector machine with Hyperband.\nThe time to train a support vector machine increases with the size of the data set.\nThis makes the data set size a suitable fidelity parameter for Hyperband.\nWe assume that you are already familiar with tuning in the mlr3 ecosystem.\nIf not, you should start with the [Hyperparameter Optimization on the Palmer Penguins Data Set](gallery/optimization/2022-11-10-hyperparameter-optimization-on-the-palmer-penguins) post.\n\n# Hyperband\n\nWe optimize the hyperparameters of the support vector machine on the [`Sonar`](https://mlr3.mlr-org.com/reference/mlr_tasks_sonar.html) data set.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(\"mlr3verse\")\nlibrary(\"mlr3hyperband\")\n\nlearner = lrn(\"classif.svm\", id = \"svm\",\n  kernel    = to_tune(c(\"linear\", \"polynomial\", \"radial\")),\n  cost      = to_tune(1e-4, 1e3, logscale = TRUE),\n  gamma     = to_tune(1e-4, 1e3, logscale = TRUE),\n  tolerance = to_tune(1e-4, 2, logscale = TRUE),\n  degree    = to_tune(2, 5),\n  type      = \"C-classification\"\n)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngraph_learner = as_learner(po(\"subsample\") %>>% learner)\n\ngraph_learner$param_set$set_values(\n  subsample.frac = to_tune(p_dbl(3^-2, 1, tags = \"budget\"))\n)\n```\n:::\n\n\nNext, we define the fidelity parameter.\nIncrease training data set size from ~ 11.1% to 100%.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ninstance = tune(\n  method = tnr(\"hyperband\", eta = 3),\n  task = tsk(\"sonar\"),\n  learner = graph_learner,\n  resampling = rsmp(\"holdout\"),\n  measures = msr(\"classif.ce\"),\n)\n```\n:::\n\n\nClick on the batches to see the optimization path of Hyperband.\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-5c81477d4da3d9a7f4a4\" class=\"reactable html-widget\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5c81477d4da3d9a7f4a4\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"subsample.frac\":[0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,1,1,1,1,1],\"classif.ce\":[0.478260869565217,0.478260869565217,0.347826086956522,0.492753623188406,0.36231884057971,0.565217391304348,0.376811594202899,0.405797101449275,0.27536231884058,0.391304347826087,0.36231884057971,0.347826086956522,0.289855072463768,0.405797101449275,0.260869565217391,0.289855072463768,0.318840579710145,0.304347826086957,0.521739130434783,0.27536231884058,0.27536231884058,0.260869565217391],\"stage\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,2,1],\"bracket\":[2,2,2,2,2,2,2,2,2,1,1,1,1,1,2,2,2,0,0,0,2,1],\"batch_nr\":[1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3]},\"columns\":[{\"accessor\":\"subsample.frac\",\"name\":\"subsample.frac\",\"type\":\"numeric\",\"aggregate\":\"max\",\"cell\":[{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"10%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"10%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"10%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"10%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"10%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"10%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"10%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"10%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"10%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.3\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"30%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.3\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"30%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.3\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"30%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.3\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"30%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.3\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"30%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.3\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"30%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.3\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"30%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"      0.3\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"30%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"        1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"100%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"        1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"100%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"        1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"100%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"        1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"100%\"},\"className\":\"bar\"},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"className\":\"bar-cell\"},\"children\":[{\"name\":\"span\",\"attribs\":{\"className\":\"number\"},\"children\":[\"        1\"]},{\"name\":\"div\",\"attribs\":{\"style\":{\"marginRight\":\"0.375rem\"},\"className\":\"bar-chart\"},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"width\":\"100%\"},\"className\":\"bar\"},\"children\":[]}]}]}]},{\"accessor\":\"classif.ce\",\"name\":\"classif.ce\",\"type\":\"numeric\",\"cell\":[\"0.48\",\"0.48\",\"0.35\",\"0.49\",\"0.36\",\"0.57\",\"0.38\",\"0.41\",\"0.28\",\"0.39\",\"0.36\",\"0.35\",\"0.29\",\"0.41\",\"0.26\",\"0.29\",\"0.32\",\"0.3\",\"0.52\",\"0.28\",\"0.28\",\"0.26\"]},{\"accessor\":\"stage\",\"name\":\"stage\",\"type\":\"numeric\"},{\"accessor\":\"bracket\",\"name\":\"bracket\",\"type\":\"numeric\"},{\"accessor\":\"batch_nr\",\"name\":\"Batch\",\"type\":\"numeric\",\"align\":\"left\"}],\"pivotBy\":[\"batch_nr\"],\"pagination\":false,\"defaultPageSize\":10,\"paginationType\":\"numbers\",\"showPageInfo\":true,\"minRows\":1,\"dataKey\":\"6d0a2ca02ebae867223092d8a9af9610\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/core-js-2.5.3/shim.min.js\"></script>\n<script src=\"../../../site_libs/react-17.0.0/react.min.js\"></script>\n<script src=\"../../../site_libs/react-17.0.0/react-dom.min.js\"></script>\n<script src=\"../../../site_libs/reactwidget-1.0.0/react-tools.js\"></script>\n<script src=\"../../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<script src=\"../../../site_libs/reactable-binding-0.3.0/reactable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}