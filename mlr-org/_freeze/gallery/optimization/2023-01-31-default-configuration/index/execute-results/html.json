{
  "hash": "6648b95e23b45cceb2a8bd20f7921cf2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Default Hyperparameter Configuration\"\ndescription: |\n  Run the default hyperparameter configuration of learners as a baseline.\ncategories:\n  - tuning\n  - classification\nauthor:\n  - name: Marc Becker\n    url: https://github.com/be-marc\ndate: 2023-01-31\nbibliography: bibliography.bib\nknitr:\n  opts_chunk:\n    R.options:\n      datatable.print.nrows: 10\n      datatable.print.class: FALSE\n      datatable.print.keys: FALSE\n      datatable.print.trunc.cols: TRUE\nimage: cover.jpg\n---\n\n\n\n\n\n\n\n# Scope\n\nThe predictive performance of modern machine learning algorithms is highly dependent on the choice of their hyperparameter configuration.\nOptions for setting hyperparameters are tuning, manual selection by the user, and using the default configuration of the algorithm.\nThe default configurations are chosen to work with a wide range of data sets but they usually do not achieve the best predictive performance.\nWhen tuning a learner in mlr3, we can run the default configuration as a baseline.\nSeeing how well it performs will tell us whether tuning pays off.\nIf the optimized configurations perform worse, we could expand the search space or try a different optimization algorithm.\nOf course, it could also be that tuning on the given data set is simply not worth it.\n\n@probst_tunability_2019 studied the tunability of machine learning algorithms.\nThey found that the tunability of algorithms varies widely.\nAlgorithms like glmnet and XGBoost are highly tunable, while algorithms like random forests work well with their default configuration.\nThe highly tunable algorithms should thus beat their baselines more easily with optimized hyperparameters.\nIn this article, we will tune the hyperparameters of a random forest and compare the performance of the default configuration with the optimized configurations.\n\n# Example\n\nWe tune the hyperparameters of the [`ranger learner`](https://mlr3learners.mlr-org.com/reference/mlr_learners_classif.ranger.html) on the [`spam`](https://mlr3.mlr-org.com/reference/mlr_tasks_spam.html) data set.\nThe search space is taken from @bischl_hyperparameter_2021.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(mlr3tuning)\nlibrary(mlr3learners)\n\nlearner = lrn(\"classif.ranger\",\n  mtry.ratio      = to_tune(0, 1),\n  replace         = to_tune(),\n  sample.fraction = to_tune(1e-1, 1),\n  num.trees       = to_tune(1, 2000)\n)\n```\n:::\n\n\n\nWhen creating the tuning instance, we pass the `mlr3tuning.default_configuration` callback to test the default hyperparameter configuration.\nThe default configuration is evaluated in the first batch of the tuning run.\nThe other batches use the specified tuning method.\nIn this example, they are randomly drawn configurations.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ninstance = tune(\n  tuner = tnr(\"random_search\", batch_size = 5),\n  task = tsk(\"spam\"),\n  learner = learner,\n  resampling = rsmp (\"holdout\"),\n  measures = msr(\"classif.ce\"),\n  term_evals = 51,\n  callbacks = clbk(\"mlr3tuning.default_configuration\")\n)\n```\n:::\n\n\n\nThe default configuration is recorded in the first row of the archive.\nThe other rows contain the results of the random search.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nas.data.table(instance$archive)[, .(batch_nr, mtry.ratio, replace, sample.fraction, num.trees, classif.ce)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    batch_nr mtry.ratio replace sample.fraction num.trees classif.ce\n 1:        1  0.1228070    TRUE       1.0000000       500 0.05345502\n 2:        2  0.3501304   FALSE       0.7508930      1333 0.05475880\n 3:        2  0.6235093   FALSE       0.3830663       682 0.06388527\n 4:        2  0.8002110   FALSE       0.8686475       466 0.06127771\n 5:        2  0.2390842    TRUE       0.4383263      1081 0.06258149\n---                                                                 \n47:       11  0.2220490    TRUE       0.3372232       486 0.06062581\n48:       11  0.9806011   FALSE       0.6418448       773 0.06323338\n49:       11  0.8375713   FALSE       0.2742567      1964 0.06779661\n50:       11  0.9514603   FALSE       0.9537379       626 0.07170795\n51:       11  0.8203689   FALSE       0.8481546       295 0.05867014\n```\n\n\n:::\n:::\n\n\n\nWe plot the performances of the evaluated hyperparameter configurations.\nThe blue line connects the best configuration of each batch.\nWe see that the default configuration already performs well and the optimized configurations can not beat it.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(mlr3viz)\n\nautoplot(instance, type = \"performance\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/2023-01-31-default-configuration-005-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n# Conlcusion\n\nThe time required to test the default configuration is negligible compared to the time required to run the hyperparameter optimization.\nIt gives us a valuable indication of whether our tuning is properly configured.\nRunning the default configuration as a baseline is a good practice that should be used in every tuning run.\n\n\n# Session Information\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsessioninfo::session_info(info = \"packages\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n═ Session info ═══════════════════════════════════════════════════════════════════════════════════════════════════════\n─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────\n ! package        * version    date (UTC) lib source\n   backports        1.5.0      2024-05-23 [1] CRAN (R 4.4.1)\n   bbotk            1.1.1      2024-10-15 [1] CRAN (R 4.4.1)\n   checkmate        2.3.2      2024-07-29 [1] CRAN (R 4.4.1)\n   cli              3.6.3      2024-06-21 [1] CRAN (R 4.4.1)\n P codetools        0.2-20     2024-03-31 [?] CRAN (R 4.4.0)\n   colorspace       2.1-1      2024-07-26 [1] CRAN (R 4.4.1)\n   crayon           1.5.3      2024-06-20 [1] CRAN (R 4.4.1)\n   data.table     * 1.16.2     2024-10-10 [1] CRAN (R 4.4.1)\n   digest           0.6.37     2024-08-19 [1] CRAN (R 4.4.1)\n   dplyr            1.1.4      2023-11-17 [1] CRAN (R 4.4.1)\n   evaluate         1.0.1      2024-10-10 [1] CRAN (R 4.4.1)\n   fansi            1.0.6      2023-12-08 [1] CRAN (R 4.4.1)\n   farver           2.1.2      2024-05-13 [1] CRAN (R 4.4.1)\n   fastmap          1.2.0      2024-05-15 [1] CRAN (R 4.4.1)\n   future           1.34.0     2024-07-29 [1] CRAN (R 4.4.1)\n   future.apply     1.11.2     2024-03-28 [1] CRAN (R 4.4.1)\n   generics         0.1.3      2022-07-05 [1] CRAN (R 4.4.1)\n   ggplot2          3.5.1      2024-04-23 [1] CRAN (R 4.4.1)\n   globals          0.16.3     2024-03-08 [1] CRAN (R 4.4.1)\n   glue             1.8.0      2024-09-30 [1] CRAN (R 4.4.1)\n   gridExtra        2.3        2017-09-09 [1] CRAN (R 4.4.1)\n   gtable           0.3.5      2024-04-22 [1] CRAN (R 4.4.1)\n   htmltools        0.5.8.1    2024-04-04 [1] CRAN (R 4.4.1)\n   htmlwidgets      1.6.4      2023-12-06 [1] CRAN (R 4.4.1)\n   jsonlite         1.8.9      2024-09-20 [1] CRAN (R 4.4.1)\n   knitr            1.48       2024-07-07 [1] CRAN (R 4.4.1)\n   labeling         0.4.3      2023-08-29 [1] CRAN (R 4.4.1)\n P lattice          0.22-5     2023-10-24 [?] CRAN (R 4.3.3)\n   lgr              0.4.4      2022-09-05 [1] CRAN (R 4.4.1)\n   lifecycle        1.0.4      2023-11-07 [1] CRAN (R 4.4.1)\n   listenv          0.9.1      2024-01-29 [1] CRAN (R 4.4.1)\n   magrittr         2.0.3      2022-03-30 [1] CRAN (R 4.4.1)\n P Matrix           1.7-0      2024-04-26 [?] CRAN (R 4.4.0)\n   mlr3           * 0.21.1     2024-10-18 [1] CRAN (R 4.4.1)\n   mlr3learners   * 0.7.0      2024-06-28 [1] CRAN (R 4.4.1)\n   mlr3measures     1.0.0      2024-09-11 [1] CRAN (R 4.4.1)\n   mlr3misc         0.15.1     2024-06-24 [1] CRAN (R 4.4.1)\n   mlr3tuning     * 1.0.2      2024-10-14 [1] CRAN (R 4.4.1)\n   mlr3viz        * 0.9.0      2024-07-01 [1] CRAN (R 4.4.1)\n   mlr3website    * 0.0.0.9000 2024-10-18 [1] Github (mlr-org/mlr3website@20d1ddf)\n   munsell          0.5.1      2024-04-01 [1] CRAN (R 4.4.1)\n   palmerpenguins   0.1.1      2022-08-15 [1] CRAN (R 4.4.1)\n   paradox        * 1.0.1      2024-07-09 [1] CRAN (R 4.4.1)\n   parallelly       1.38.0     2024-07-27 [1] CRAN (R 4.4.1)\n   pillar           1.9.0      2023-03-22 [1] CRAN (R 4.4.1)\n   pkgconfig        2.0.3      2019-09-22 [1] CRAN (R 4.4.1)\n   R6               2.5.1      2021-08-19 [1] CRAN (R 4.4.1)\n   ranger           0.16.0     2023-11-12 [1] CRAN (R 4.4.1)\n   Rcpp             1.0.13     2024-07-17 [1] CRAN (R 4.4.1)\n   renv             1.0.11     2024-10-12 [1] CRAN (R 4.4.1)\n   rlang            1.1.4      2024-06-04 [1] CRAN (R 4.4.1)\n   rmarkdown        2.28       2024-08-17 [1] CRAN (R 4.4.1)\n   scales           1.3.0      2023-11-28 [1] CRAN (R 4.4.1)\n   sessioninfo      1.2.2      2021-12-06 [1] CRAN (R 4.4.1)\n   stringi          1.8.4      2024-05-06 [1] CRAN (R 4.4.1)\n   tibble           3.2.1      2023-03-20 [1] CRAN (R 4.4.1)\n   tidyselect       1.2.1      2024-03-11 [1] CRAN (R 4.4.1)\n   utf8             1.2.4      2023-10-22 [1] CRAN (R 4.4.1)\n   uuid             1.2-1      2024-07-29 [1] CRAN (R 4.4.1)\n   vctrs            0.6.5      2023-12-01 [1] CRAN (R 4.4.1)\n   viridis          0.6.5      2024-01-29 [1] CRAN (R 4.4.1)\n   viridisLite      0.4.2      2023-05-02 [1] CRAN (R 4.4.1)\n   withr            3.0.1      2024-07-31 [1] CRAN (R 4.4.1)\n   xfun             0.48       2024-10-03 [1] CRAN (R 4.4.1)\n   yaml             2.3.10     2024-07-26 [1] CRAN (R 4.4.1)\n\n [1] /home/marc/repositories/mlr3website/mlr-org/renv/library/linux-ubuntu-noble/R-4.4/x86_64-pc-linux-gnu\n [2] /home/marc/.cache/R/renv/sandbox/linux-ubuntu-noble/R-4.4/x86_64-pc-linux-gnu/9a444a72\n\n P ── Loaded and on-disk path mismatch.\n\n──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}